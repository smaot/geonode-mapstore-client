(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[24372],{957043:(e,t,s)=>{var n=s(862488),r=s(121078),i=s(200278),o=s(701469);e.exports=function(){var e=arguments.length;if(!e)return[];for(var t=Array(e-1),s=arguments[0],a=e;a--;)t[a-1]=arguments[a];return n(o(s)?i(s):[s],r(t,1))}},650141:(e,t,s)=>{"use strict";s.d(t,{Z:()=>x});var n=s(919629),r=s(173381),i=s(938024),o=s(273101),a=s(925753),h=s(864011),l=s(421915),u=s(690728),g=s(15265),c=s(218672),d=s(949179),m=s(613002);function _(e){return e.feature?e.feature:e.element?e.element:null}const f=[];class p extends i.Z{constructor(e){const t=e=e||{};t.handleDownEvent||(t.handleDownEvent=h.uX),t.stopDown||(t.stopDown=h.Dv),super(t),this.source_=e.source?e.source:null,this.vertex_=void 0===e.vertex||e.vertex,this.edge_=void 0===e.edge||e.edge,this.features_=e.features?e.features:null,this.featuresListenerKeys_=[],this.featureChangeListenerKeys_={},this.indexedFeaturesExtents_={},this.pendingFeatures_={},this.pixelTolerance_=void 0!==e.pixelTolerance?e.pixelTolerance:10,this.rBush_=new o.Z,this.GEOMETRY_SEGMENTERS_={Point:this.segmentPointGeometry_.bind(this),LineString:this.segmentLineStringGeometry_.bind(this),LinearRing:this.segmentLineStringGeometry_.bind(this),Polygon:this.segmentPolygonGeometry_.bind(this),MultiPoint:this.segmentMultiPointGeometry_.bind(this),MultiLineString:this.segmentMultiLineStringGeometry_.bind(this),MultiPolygon:this.segmentMultiPolygonGeometry_.bind(this),GeometryCollection:this.segmentGeometryCollectionGeometry_.bind(this),Circle:this.segmentCircleGeometry_.bind(this)}}addFeature(e,t){t=void 0===t||t;const s=(0,d.sq)(e),n=e.getGeometry();if(n){const t=this.GEOMETRY_SEGMENTERS_[n.getType()];if(t){this.indexedFeaturesExtents_[s]=n.getExtent((0,l.lJ)());const r=[];if(t(r,n),1===r.length)this.rBush_.insert((0,l.hI)(r[0]),{feature:e,segment:r[0]});else if(r.length>1){const t=r.map((e=>(0,l.hI)(e))),s=r.map((t=>({feature:e,segment:t})));this.rBush_.load(t,s)}}}t&&(this.featureChangeListenerKeys_[s]=(0,m.oL)(e,r.Z.CHANGE,this.handleFeatureChange_,this))}getFeatures_(){let e;return this.features_?e=this.features_:this.source_&&(e=this.source_.getFeatures()),e}handleEvent(e){const t=this.snapTo(e.pixel,e.coordinate,e.map);return t&&(e.coordinate=t.vertex.slice(0,2),e.pixel=t.vertexPixel),super.handleEvent(e)}handleFeatureAdd_(e){const t=_(e);t&&this.addFeature(t)}handleFeatureRemove_(e){const t=_(e);t&&this.removeFeature(t)}handleFeatureChange_(e){const t=e.target;if(this.handlingDownUpSequence){const e=(0,d.sq)(t);e in this.pendingFeatures_||(this.pendingFeatures_[e]=t)}else this.updateFeature_(t)}handleUpEvent(e){const t=Object.values(this.pendingFeatures_);return t.length&&(t.forEach(this.updateFeature_.bind(this)),this.pendingFeatures_={}),!1}removeFeature(e,t){const s=void 0===t||t,n=(0,d.sq)(e),r=this.indexedFeaturesExtents_[n];if(r){const t=this.rBush_,s=[];t.forEachInExtent(r,(function(t){e===t.feature&&s.push(t)}));for(let e=s.length-1;e>=0;--e)t.remove(s[e])}s&&((0,m.bN)(this.featureChangeListenerKeys_[n]),delete this.featureChangeListenerKeys_[n])}setMap(e){const t=this.getMap(),s=this.featuresListenerKeys_,r=this.getFeatures_();t&&(s.forEach(m.bN),s.length=0,this.rBush_.clear(),Object.values(this.featureChangeListenerKeys_).forEach(m.bN),this.featureChangeListenerKeys_={}),super.setMap(e),e&&(this.features_?s.push((0,m.oL)(this.features_,n.Z.ADD,this.handleFeatureAdd_,this),(0,m.oL)(this.features_,n.Z.REMOVE,this.handleFeatureRemove_,this)):this.source_&&s.push((0,m.oL)(this.source_,a.Z.ADDFEATURE,this.handleFeatureAdd_,this),(0,m.oL)(this.source_,a.Z.REMOVEFEATURE,this.handleFeatureRemove_,this)),r.forEach((e=>this.addFeature(e))))}snapTo(e,t,s){const n=s.getView().getProjection(),r=(0,c.Vs)(t,n),i=(0,c.Fj)((0,l.f3)((0,l.hI)([r]),s.getView().getResolution()*this.pixelTolerance_),n),o=this.rBush_.getInExtent(i),a=o.length;if(0===a)return null;let h,g=1/0;const d=this.pixelTolerance_*this.pixelTolerance_,m=()=>{if(h){const t=s.getPixelFromCoordinate(h);if((0,u.bI)(e,t)<=d)return{vertex:h,vertexPixel:[Math.round(t[0]),Math.round(t[1])]}}return null};if(this.vertex_){for(let e=0;e<a;++e){const t=o[e];"Circle"!==t.feature.getGeometry().getType()&&t.segment.forEach((e=>{const t=(0,c.Vs)(e,n),s=(0,u.bI)(r,t);s<g&&(h=e,g=s)}))}const e=m();if(e)return e}if(this.edge_){for(let e=0;e<a;++e){let t=null;const s=o[e];if("Circle"===s.feature.getGeometry().getType()){let e=s.feature.getGeometry();const i=(0,c.Cs)();i&&(e=e.clone().transform(i,n)),t=(0,u.Ed)(r,e)}else{const[e,i]=s.segment;i&&(f[0]=(0,c.Vs)(e,n),f[1]=(0,c.Vs)(i,n),t=(0,u.oL)(r,f))}if(t){const e=(0,u.bI)(r,t);e<g&&(h=(0,c.lO)(t,n),g=e)}}const e=m();if(e)return e}return null}updateFeature_(e){this.removeFeature(e,!1),this.addFeature(e,!1)}segmentCircleGeometry_(e,t){const s=this.getMap().getView().getProjection();let n=t;const r=(0,c.Cs)();r&&(n=n.clone().transform(r,s));const i=(0,g.Bb)(n);r&&i.transform(s,r);const o=i.getCoordinates()[0];for(let t=0,s=o.length-1;t<s;++t)e.push(o.slice(t,t+2))}segmentGeometryCollectionGeometry_(e,t){const s=t.getGeometriesArray();for(let t=0;t<s.length;++t){const n=this.GEOMETRY_SEGMENTERS_[s[t].getType()];n&&n(e,s[t])}}segmentLineStringGeometry_(e,t){const s=t.getCoordinates();for(let t=0,n=s.length-1;t<n;++t)e.push(s.slice(t,t+2))}segmentMultiLineStringGeometry_(e,t){const s=t.getCoordinates();for(let t=0,n=s.length;t<n;++t){const n=s[t];for(let t=0,s=n.length-1;t<s;++t)e.push(n.slice(t,t+2))}}segmentMultiPointGeometry_(e,t){t.getCoordinates().forEach((t=>{e.push([t])}))}segmentMultiPolygonGeometry_(e,t){const s=t.getCoordinates();for(let t=0,n=s.length;t<n;++t){const n=s[t];for(let t=0,s=n.length;t<s;++t){const s=n[t];for(let t=0,n=s.length-1;t<n;++t)e.push(s.slice(t,t+2))}}}segmentPointGeometry_(e,t){e.push([t.getCoordinates()])}segmentPolygonGeometry_(e,t){const s=t.getCoordinates();for(let t=0,n=s.length;t<n;++t){const n=s[t];for(let t=0,s=n.length-1;t<s;++t)e.push(n.slice(t,t+2))}}}const x=p},685246:(e,t,s)=>{"use strict";s.d(t,{Z:()=>m});var n=s(677701);class r extends n.Z{constructor(e){super(e=e||{})}}const i=r;var o=s(704089),a=s(611256),h=s(706908),l=s(782359),u=s(421915),g=s(218672);class c extends o.Z{constructor(e){super(e),this.image_=null}getImage(){return this.image_?this.image_.getImage():null}prepareFrame(e){const t=e.layerStatesArray[e.layerIndex],s=e.pixelRatio,n=e.viewState,r=n.resolution,i=this.getLayer().getSource(),o=e.viewHints;let l=e.extent;if(void 0!==t.extent&&(l=(0,u.Ed)(l,(0,g.dY)(t.extent,n.projection))),!o[h.Z.ANIMATING]&&!o[h.Z.INTERACTING]&&!(0,u.xb)(l))if(i){const e=n.projection,t=i.getImage(l,r,s,e);t&&(this.loadImage(t)?this.image_=t:t.getState()===a.Z.EMPTY&&(this.image_=null))}else this.image_=null;return!!this.image_}getData(e){const t=this.frameState;if(!t)return null;const s=this.getLayer(),n=(0,l.nn)(t.pixelToCoordinateTransform,e.slice()),r=s.getExtent();if(r&&!(0,u.b8)(r,n))return null;const i=this.image_.getExtent(),o=this.getImage(),a=(0,u.dz)(i),h=Math.floor(o.width*((n[0]-i[0])/a));if(h<0||h>=o.width)return null;const g=(0,u.Cr)(i),c=Math.floor(o.height*((i[3]-n[1])/g));return c<0||c>=o.height?null:this.getImageData(o,h,c)}renderFrame(e,t){const s=this.image_,n=s.getExtent(),r=s.getResolution(),i=s.getPixelRatio(),o=e.layerStatesArray[e.layerIndex],a=e.pixelRatio,h=e.viewState,c=h.center,d=a*r/(h.resolution*i),m=e.extent,_=h.resolution,f=h.rotation,p=Math.round((0,u.dz)(m)/_*a),x=Math.round((0,u.Cr)(m)/_*a);(0,l.qC)(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/a,1/a,f,-p/2,-x/2),(0,l.nb)(this.inversePixelTransform,this.pixelTransform);const y=(0,l.BB)(this.pixelTransform);this.useContainer(t,y,this.getBackground(e));const E=this.context,v=E.canvas;v.width!=p||v.height!=x?(v.width=p,v.height=x):this.containerReused||E.clearRect(0,0,p,x);let C=!1,F=!0;if(o.extent){const t=(0,g.dY)(o.extent,h.projection);F=(0,u.kK)(t,e.extent),C=F&&!(0,u.r4)(t,e.extent),C&&this.clipUnrotated(E,e,t)}const G=this.getImage(),T=(0,l.qC)(this.tempTransform,p/2,x/2,d,d,0,i*(n[0]-c[0])/r,i*(c[1]-n[3])/r);this.renderedResolution=r*a/i;const b=G.width*T[0],M=G.height*T[3];if(this.getLayer().getSource().getInterpolate()||(E.imageSmoothingEnabled=!1),this.preRender(E,e),F&&b>=.5&&M>=.5){const e=T[4],t=T[5],s=o.opacity;let n;1!==s&&(n=E.globalAlpha,E.globalAlpha=s),E.drawImage(G,0,0,+G.width,+G.height,e,t,b,M),1!==s&&(E.globalAlpha=n)}return this.postRender(E,e),C&&E.restore(),E.imageSmoothingEnabled=!0,y!==v.style.transform&&(v.style.transform=y),this.container}}const d=c,m=class extends i{constructor(e){super(e)}createRenderer(){return new d(this)}getData(e){return super.getData(e)}}}}]);