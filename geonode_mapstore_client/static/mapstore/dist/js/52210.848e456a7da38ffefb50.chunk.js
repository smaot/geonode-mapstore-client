(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[52210],{51273:(t,e,i)=>{"use strict";i.d(e,{Z:()=>v});var s=i(378426),r=i(919629),n=i(9520),a=i(623068),o=i(247588),l=i(473392),h=i(864011),u=i(913580),d=i(831219),c=i(179682),_=i(949179),f=i(436403);class g extends n.ZP{constructor(t,e,i,s){super(t),this.selected=e,this.deselected=i,this.mapBrowserEvent=s}}const y={};class p extends o.ZP{constructor(t){let e;if(super(),this.on,this.once,this.un,t=t||{},this.boundAddFeature_=this.addFeature_.bind(this),this.boundRemoveFeature_=this.removeFeature_.bind(this),this.condition_=t.condition?t.condition:f.Kf,this.addCondition_=t.addCondition?t.addCondition:f.Fi,this.removeCondition_=t.removeCondition?t.removeCondition:f.Fi,this.toggleCondition_=t.toggleCondition?t.toggleCondition:f.vY,this.multi_=!!t.multi&&t.multi,this.filter_=t.filter?t.filter:h.uX,this.hitTolerance_=t.hitTolerance?t.hitTolerance:0,this.style_=void 0!==t.style?t.style:function(){const t=(0,d.Ly)();return(0,c.l7)(t.Polygon,t.LineString),(0,c.l7)(t.GeometryCollection,t.LineString),function(e){return e.getGeometry()?t[e.getGeometry().getType()]:null}}(),this.features_=t.features||new s.Z,t.layers)if("function"==typeof t.layers)e=t.layers;else{const i=t.layers;e=function(t){return i.includes(t)}}else e=h.uX;this.layerFilter_=e,this.featureLayerAssociation_={}}addFeatureLayerAssociation_(t,e){this.featureLayerAssociation_[(0,_.sq)(t)]=e}getFeatures(){return this.features_}getHitTolerance(){return this.hitTolerance_}getLayer(t){return this.featureLayerAssociation_[(0,_.sq)(t)]}setHitTolerance(t){this.hitTolerance_=t}setMap(t){this.getMap()&&this.style_&&this.features_.forEach(this.restorePreviousStyle_.bind(this)),super.setMap(t),t?(this.features_.addEventListener(r.Z.ADD,this.boundAddFeature_),this.features_.addEventListener(r.Z.REMOVE,this.boundRemoveFeature_),this.style_&&this.features_.forEach(this.applySelectedStyle_.bind(this))):(this.features_.removeEventListener(r.Z.ADD,this.boundAddFeature_),this.features_.removeEventListener(r.Z.REMOVE,this.boundRemoveFeature_))}addFeature_(t){const e=t.element;if(this.style_&&this.applySelectedStyle_(e),!this.getLayer(e)){const t=this.getMap().getAllLayers().find((function(t){if(t instanceof l.Z&&t.getSource()&&t.getSource().hasFeature(e))return t}));t&&this.addFeatureLayerAssociation_(e,t)}}removeFeature_(t){this.style_&&this.restorePreviousStyle_(t.element)}getStyle(){return this.style_}applySelectedStyle_(t){const e=(0,_.sq)(t);e in y||(y[e]=t.getStyle()),t.setStyle(this.style_)}restorePreviousStyle_(t){const e=this.getMap().getInteractions().getArray();for(let i=e.length-1;i>=0;--i){const s=e[i];if(s!==this&&s instanceof p&&s.getStyle()&&-1!==s.getFeatures().getArray().lastIndexOf(t))return void t.setStyle(s.getStyle())}const i=(0,_.sq)(t);t.setStyle(y[i]),delete y[i]}removeFeatureLayerAssociation_(t){delete this.featureLayerAssociation_[(0,_.sq)(t)]}handleEvent(t){if(!this.condition_(t))return!0;const e=this.addCondition_(t),i=this.removeCondition_(t),s=this.toggleCondition_(t),r=!e&&!i&&!s,n=t.map,o=this.getFeatures(),l=[],h=[];if(r){(0,u.Z)(this.featureLayerAssociation_),n.forEachFeatureAtPixel(t.pixel,((t,e)=>{if(t instanceof a.Z&&this.filter_(t,e))return this.addFeatureLayerAssociation_(t,e),h.push(t),!this.multi_}),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(let t=o.getLength()-1;t>=0;--t){const e=o.item(t),i=h.indexOf(e);i>-1?h.splice(i,1):(o.remove(e),l.push(e))}0!==h.length&&o.extend(h)}else{n.forEachFeatureAtPixel(t.pixel,((t,r)=>{if(t instanceof a.Z&&this.filter_(t,r))return!e&&!s||o.getArray().includes(t)?(i||s)&&o.getArray().includes(t)&&(l.push(t),this.removeFeatureLayerAssociation_(t)):(this.addFeatureLayerAssociation_(t,r),h.push(t)),!this.multi_}),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(let t=l.length-1;t>=0;--t)o.remove(l[t]);o.extend(h)}return(h.length>0||l.length>0)&&this.dispatchEvent(new g("select",h,l,t)),!0}}const v=p},829194:(t,e,i)=>{"use strict";i.d(e,{Z:()=>_});var s=i(378426),r=i(9520),n=i(623068),a=i(173604),o=i(938024),l=i(864011),h=i(436403),u=i(218672);class d extends r.ZP{constructor(t,e,i,s,r){super(t),this.features=e,this.coordinate=i,this.startCoordinate=s,this.mapBrowserEvent=r}}class c extends o.Z{constructor(t){let e;if(super(t=t||{}),this.on,this.once,this.un,this.lastCoordinate_=null,this.startCoordinate_=null,this.features_=void 0!==t.features?t.features:null,t.layers&&!this.features_)if("function"==typeof t.layers)e=t.layers;else{const i=t.layers;e=function(t){return i.includes(t)}}else e=l.uX;this.layerFilter_=e,this.filter_=t.filter&&!this.features_?t.filter:l.uX,this.hitTolerance_=t.hitTolerance?t.hitTolerance:0,this.condition_=t.condition?t.condition:h.Bx,this.lastFeature_=null,this.addChangeListener(a.Z.ACTIVE,this.handleActiveChanged_)}handleDownEvent(t){if(!t.originalEvent||!this.condition_(t))return!1;if(this.lastFeature_=this.featuresAtPixel_(t.pixel,t.map),!this.lastCoordinate_&&this.lastFeature_){this.startCoordinate_=t.coordinate,this.lastCoordinate_=t.coordinate,this.handleMoveEvent(t);const e=this.features_||new s.Z([this.lastFeature_]);return this.dispatchEvent(new d("translatestart",e,t.coordinate,this.startCoordinate_,t)),!0}return!1}handleUpEvent(t){if(this.lastCoordinate_){this.lastCoordinate_=null,this.handleMoveEvent(t);const e=this.features_||new s.Z([this.lastFeature_]);return this.dispatchEvent(new d("translateend",e,t.coordinate,this.startCoordinate_,t)),this.startCoordinate_=null,!0}return!1}handleDragEvent(t){if(this.lastCoordinate_){const e=t.coordinate,i=t.map.getView().getProjection(),r=(0,u.Vs)(e,i),n=(0,u.Vs)(this.lastCoordinate_,i),a=r[0]-n[0],o=r[1]-n[1],l=this.features_||new s.Z([this.lastFeature_]),h=(0,u.Cs)();l.forEach((function(t){const e=t.getGeometry();h?(e.transform(h,i),e.translate(a,o),e.transform(i,h)):e.translate(a,o),t.setGeometry(e)})),this.lastCoordinate_=e,this.dispatchEvent(new d("translating",l,e,this.startCoordinate_,t))}}handleMoveEvent(t){const e=t.map.getViewport();this.featuresAtPixel_(t.pixel,t.map)?(e.classList.remove(this.lastCoordinate_?"ol-grab":"ol-grabbing"),e.classList.add(this.lastCoordinate_?"ol-grabbing":"ol-grab")):e.classList.remove("ol-grab","ol-grabbing")}featuresAtPixel_(t,e){return e.forEachFeatureAtPixel(t,((t,e)=>{if(t instanceof n.Z&&this.filter_(t,e)&&(!this.features_||this.features_.getArray().includes(t)))return t}),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_})}getHitTolerance(){return this.hitTolerance_}setHitTolerance(t){this.hitTolerance_=t}setMap(t){const e=this.getMap();super.setMap(t),this.updateState_(e)}handleActiveChanged_(){this.updateState_(null)}updateState_(t){let e=this.getMap();const i=this.getActive();e&&i||(e=e||t,!e)||e.getViewport().classList.remove("ol-grab","ol-grabbing")}}const _=c}}]);