(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[85828],{378426:(t,e,i)=>{"use strict";i.d(e,{Z:()=>c});var s=i(665045),n=i(558493),r=i(919629),o=i(9520);const h="length";class a extends o.ZP{constructor(t,e,i){super(t),this.element=e,this.index=i}}class l extends n.Z{constructor(t,e){if(super(),this.on,this.once,this.un,e=e||{},this.unique_=!!e.unique,this.array_=t||[],this.unique_)for(let t=0,e=this.array_.length;t<e;++t)this.assertUnique_(this.array_[t],t);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(t){for(let e=0,i=t.length;e<i;++e)this.push(t[e]);return this}forEach(t){const e=this.array_;for(let i=0,s=e.length;i<s;++i)t(e[i],i,e)}getArray(){return this.array_}item(t){return this.array_[t]}getLength(){return this.get(h)}insertAt(t,e){if(t<0||t>this.getLength())throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new a(r.Z.ADD,e,t))}pop(){return this.removeAt(this.getLength()-1)}push(t){this.unique_&&this.assertUnique_(t);const e=this.getLength();return this.insertAt(e,t),this.getLength()}remove(t){const e=this.array_;for(let i=0,s=e.length;i<s;++i)if(e[i]===t)return this.removeAt(i)}removeAt(t){if(t<0||t>=this.getLength())return;const e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new a(r.Z.REMOVE,e,t)),e}setAt(t,e){if(t>=this.getLength())return void this.insertAt(t,e);if(t<0)throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e,t);const i=this.array_[t];this.array_[t]=e,this.dispatchEvent(new a(r.Z.REMOVE,i,t)),this.dispatchEvent(new a(r.Z.ADD,e,t))}updateLength_(){this.set(h,this.array_.length)}assertUnique_(t,e){for(let i=0,n=this.array_.length;i<n;++i)if(this.array_[i]===t&&i!==e)throw new s.Z(58)}}const c=l},919629:(t,e,i)=>{"use strict";i.d(e,{Z:()=>s});const s={ADD:"add",REMOVE:"remove"}},280800:(t,e,i)=>{"use strict";i.d(e,{ov:()=>r,Be:()=>o});var s=i(864011);let n=!1;function r(t,e,i,s,r,o,h){const a=new XMLHttpRequest;a.open("GET","function"==typeof t?t(i,s,r):t,!0),"arraybuffer"==e.getType()&&(a.responseType="arraybuffer"),a.withCredentials=n,a.onload=function(t){if(!a.status||a.status>=200&&a.status<300){const t=e.getType();let s;"json"==t||"text"==t?s=a.responseText:"xml"==t?(s=a.responseXML,s||(s=(new DOMParser).parseFromString(a.responseText,"application/xml"))):"arraybuffer"==t&&(s=a.response),s?o(e.readFeatures(s,{extent:i,featureProjection:r}),e.readProjection(s)):h()}else h()},a.onerror=h,a.send()}function o(t,e){return function(i,n,o,h,a){const l=this;r(t,e,i,n,o,(function(t,e){l.addFeatures(t),void 0!==h&&h(t)}),a||s.Zn)}}},384385:(t,e,i)=>{"use strict";i.d(e,{Z:()=>y});var s=i(677701),n=i(382582),r=i(831219),o=i(409371),h=i(898185),a=i(639166),l=i(218663),c=i(120767),u=i(315565);function d(t){return new r.ZP({fill:g(t,""),stroke:_(t,""),text:f(t),image:p(t)})}function g(t,e){const i=t[e+"fill-color"];if(i)return new h.Z({color:i})}function _(t,e){const i=t[e+"stroke-width"],s=t[e+"stroke-color"];if(i||s)return new c.Z({width:i,color:s,lineCap:t[e+"stroke-line-cap"],lineJoin:t[e+"stroke-line-join"],lineDash:t[e+"stroke-line-dash"],lineDashOffset:t[e+"stroke-line-dash-offset"],miterLimit:t[e+"stroke-miter-limit"]})}function f(t){const e=t["text-value"];if(e)return new u.Z({text:e,font:t["text-font"],maxAngle:t["text-max-angle"],offsetX:t["text-offset-x"],offsetY:t["text-offset-y"],overflow:t["text-overflow"],placement:t["text-placement"],repeat:t["text-repeat"],scale:t["text-scale"],rotateWithView:t["text-rotate-with-view"],rotation:t["text-rotation"],textAlign:t["text-align"],justify:t["text-justify"],textBaseline:t["text-baseline"],padding:t["text-padding"],fill:g(t,"text-"),backgroundFill:g(t,"text-background-"),stroke:_(t,"text-"),backgroundStroke:_(t,"text-background-")})}function p(t){const e=t["icon-src"],i=t["icon-img"];if(e||i)return new a.Z({src:e,img:i,imgSize:t["icon-img-size"],anchor:t["icon-anchor"],anchorOrigin:t["icon-anchor-origin"],anchorXUnits:t["icon-anchor-x-units"],anchorYUnits:t["icon-anchor-y-units"],color:t["icon-color"],crossOrigin:t["icon-cross-origin"],offset:t["icon-offset"],displacement:t["icon-displacement"],opacity:t["icon-opacity"],scale:t["icon-scale"],width:t["icon-width"],height:t["icon-height"],rotation:t["icon-rotation"],rotateWithView:t["icon-rotate-with-view"],size:t["icon-size"],declutterMode:t["icon-declutter-mode"]});const s=t["shape-points"];if(s){const e="shape-";return new l.Z({points:s,fill:g(t,e),stroke:_(t,e),radius:t["shape-radius"],radius1:t["shape-radius1"],radius2:t["shape-radius2"],angle:t["shape-angle"],displacement:t["shape-displacement"],rotation:t["shape-rotation"],rotateWithView:t["shape-rotate-with-view"],scale:t["shape-scale"],declutterMode:t["shape-declutter-mode"]})}const n=t["circle-radius"];if(n){const e="circle-";return new o.Z({radius:n,fill:g(t,e),stroke:_(t,e),displacement:t["circle-displacement"],scale:t["circle-scale"],rotation:t["circle-rotation"],rotateWithView:t["circle-rotate-with-view"],declutterMode:t["circle-declutter-mode"]})}}const x="renderOrder";class m extends s.Z{constructor(t){t=t||{};const e=Object.assign({},t);delete e.style,delete e.renderBuffer,delete e.updateWhileAnimating,delete e.updateWhileInteracting,super(e),this.declutter_=void 0!==t.declutter&&t.declutter,this.renderBuffer_=void 0!==t.renderBuffer?t.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(t.style),this.updateWhileAnimating_=void 0!==t.updateWhileAnimating&&t.updateWhileAnimating,this.updateWhileInteracting_=void 0!==t.updateWhileInteracting&&t.updateWhileInteracting}getDeclutter(){return this.declutter_}getFeatures(t){return super.getFeatures(t)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(x)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(t){t.declutterTree||(t.declutterTree=new n(9)),this.getRenderer().renderDeclutter(t)}setRenderOrder(t){this.set(x,t)}setStyle(t){let e;if(void 0===t)e=r.yF;else if(null===t)e=null;else if("function"==typeof t)e=t;else if(t instanceof r.ZP)e=t;else if(Array.isArray(t)){const i=t.length,s=new Array(i);for(let e=0;e<i;++e){const i=t[e];i instanceof r.ZP?s[e]=i:s[e]=d(i)}e=s}else e=d(t);this.style_=e,this.styleFunction_=null===t?void 0:(0,r.J$)(this.style_),this.changed()}}const y=m},473392:(t,e,i)=>{"use strict";i.d(e,{Z:()=>S});var s=i(384385),n=i(95965),r=i(704089),o=i(983183),h=i(706908),a=i(617356),l=i(782359),c=i(421915),u=i(85386),d=i(243631),g=i(179682),_=i(218672),f=i(949179),p=i(690728);class x extends r.Z{constructor(t){super(t),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=(0,c.lJ)(),this.wrappedRenderedExtent_=(0,c.lJ)(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedRenderOrder_=null,this.replayGroup_=null,this.replayGroupChanged=!0,this.declutterExecutorGroup=null,this.clipping=!0,this.compositionContext_=null,this.opacity_=1}renderWorlds(t,e,i){const s=e.extent,n=e.viewState,r=n.center,o=n.resolution,a=n.projection,l=n.rotation,u=a.getExtent(),d=this.getLayer().getSource(),g=e.pixelRatio,_=e.viewHints,f=!(_[h.Z.ANIMATING]||_[h.Z.INTERACTING]),p=this.compositionContext_,x=Math.round(e.size[0]*g),m=Math.round(e.size[1]*g),y=d.getWrapX()&&a.canWrapX(),S=y?(0,c.dz)(u):null,E=y?Math.ceil((s[2]-u[2])/S)+1:1;let v=y?Math.floor((s[0]-u[0])/S):0;do{const e=this.getRenderTransform(r,o,l,g,x,m,v*S);t.execute(p,1,e,l,f,void 0,i)}while(++v<E)}setupCompositionContext_(){if(1!==this.opacity_){const t=(0,u.E4)(this.context.canvas.width,this.context.canvas.height,r.r);this.compositionContext_=t}else this.compositionContext_=this.context}releaseCompositionContext_(){if(1!==this.opacity_){const t=this.context.globalAlpha;this.context.globalAlpha=this.opacity_,this.context.drawImage(this.compositionContext_.canvas,0,0),this.context.globalAlpha=t,(0,u.jy)(this.compositionContext_),r.r.push(this.compositionContext_.canvas),this.compositionContext_=null}}renderDeclutter(t){this.declutterExecutorGroup&&(this.setupCompositionContext_(),this.renderWorlds(this.declutterExecutorGroup,t,t.declutterTree),this.releaseCompositionContext_())}renderFrame(t,e){const i=t.pixelRatio,s=t.layerStatesArray[t.layerIndex];(0,l.n3)(this.pixelTransform,1/i,1/i),(0,l.nb)(this.inversePixelTransform,this.pixelTransform);const n=(0,l.BB)(this.pixelTransform);this.useContainer(e,n,this.getBackground(t));const r=this.context,o=r.canvas,h=this.replayGroup_,a=this.declutterExecutorGroup;if((!h||h.isEmpty())&&(!a||a.isEmpty()))return null;const u=Math.round(t.size[0]*i),d=Math.round(t.size[1]*i);o.width!=u||o.height!=d?(o.width=u,o.height=d,o.style.transform!==n&&(o.style.transform=n)):this.containerReused||r.clearRect(0,0,u,d),this.preRender(r,t);const g=t.viewState,f=g.projection;this.opacity_=s.opacity,this.setupCompositionContext_();let p=!1,x=!0;if(s.extent&&this.clipping){const e=(0,_.dY)(s.extent,f);x=(0,c.kK)(e,t.extent),p=x&&!(0,c.r4)(e,t.extent),p&&this.clipUnrotated(this.compositionContext_,t,e)}return x&&this.renderWorlds(h,t),p&&this.compositionContext_.restore(),this.releaseCompositionContext_(),this.postRender(r,t),this.renderedRotation_!==g.rotation&&(this.renderedRotation_=g.rotation,this.hitDetectionImageData_=null),this.container}getFeatures(t){return new Promise((e=>{if(!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const t=[this.context.canvas.width,this.context.canvas.height];(0,l.nn)(this.pixelTransform,t);const e=this.renderedCenter_,i=this.renderedResolution_,s=this.renderedRotation_,n=this.renderedProjection_,r=this.wrappedRenderedExtent_,o=this.getLayer(),h=[],u=t[0]*a.UN,d=t[1]*a.UN;h.push(this.getRenderTransform(e,i,s,a.UN,u,d,0).slice());const g=o.getSource(),_=n.getExtent();if(g.getWrapX()&&n.canWrapX()&&!(0,c.r4)(_,r)){let t=r[0];const n=(0,c.dz)(_);let o,l=0;for(;t<_[0];)--l,o=n*l,h.push(this.getRenderTransform(e,i,s,a.UN,u,d,o).slice()),t+=n;for(l=0,t=r[2];t>_[2];)++l,o=n*l,h.push(this.getRenderTransform(e,i,s,a.UN,u,d,o).slice()),t-=n}this.hitDetectionImageData_=(0,a.TU)(t,h,this.renderedFeatures_,o.getStyleFunction(),r,i,s)}e((0,a.ix)(t,this.renderedFeatures_,this.hitDetectionImageData_))}))}forEachFeatureAtCoordinate(t,e,i,s,n){if(!this.replayGroup_)return;const r=e.viewState.resolution,o=e.viewState.rotation,h=this.getLayer(),a={},l=function(t,e,i){const r=(0,f.sq)(t),o=a[r];if(o){if(!0!==o&&i<o.distanceSq){if(0===i)return a[r]=!0,n.splice(n.lastIndexOf(o),1),s(t,h,e);o.geometry=e,o.distanceSq=i}}else{if(0===i)return a[r]=!0,s(t,h,e);n.push(a[r]={feature:t,layer:h,geometry:e,distanceSq:i,callback:s})}};let c;const u=[this.replayGroup_];return this.declutterExecutorGroup&&u.push(this.declutterExecutorGroup),u.some((s=>c=s.forEachFeatureAtCoordinate(t,r,o,i,l,s===this.declutterExecutorGroup&&e.declutterTree?e.declutterTree.all().map((t=>t.value)):null))),c}handleFontsChanged(){const t=this.getLayer();t.getVisible()&&this.replayGroup_&&t.changed()}handleStyleImageChange_(t){this.renderIfReadyAndVisible()}prepareFrame(t){const e=this.getLayer(),i=e.getSource();if(!i)return!1;const s=t.viewHints[h.Z.ANIMATING],r=t.viewHints[h.Z.INTERACTING],a=e.getUpdateWhileAnimating(),l=e.getUpdateWhileInteracting();if(this.ready&&!a&&s||!l&&r)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const u=t.extent,f=t.viewState,x=f.projection,m=f.resolution,y=t.pixelRatio,S=e.getRevision(),E=e.getRenderBuffer();let v=e.getRenderOrder();void 0===v&&(v=d.eR);const I=f.center.slice(),C=(0,c.f3)(u,E*m),R=C.slice(),F=[C.slice()],T=x.getExtent();if(i.getWrapX()&&x.canWrapX()&&!(0,c.r4)(T,t.extent)){const t=(0,c.dz)(T),e=Math.max((0,c.dz)(C)/2,t);C[0]=T[0]-e,C[2]=T[2]+e,(0,p.Cf)(I,x);const i=(0,c.Cf)(F[0],x);i[0]<T[0]&&i[2]<T[2]?F.push([i[0]+t,i[1],i[2]+t,i[3]]):i[0]>T[0]&&i[2]>T[2]&&F.push([i[0]-t,i[1],i[2]-t,i[3]])}if(this.ready&&this.renderedResolution_==m&&this.renderedRevision_==S&&this.renderedRenderOrder_==v&&(0,c.r4)(this.wrappedRenderedExtent_,C))return(0,g.fS)(this.renderedExtent_,R)||(this.hitDetectionImageData_=null,this.renderedExtent_=R),this.renderedCenter_=I,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const w=new n.Z((0,d.Qz)(m,y),C,m,y);let D;this.getLayer().getDeclutter()&&(D=new n.Z((0,d.Qz)(m,y),C,m,y));const k=(0,_.Cs)();let L;if(k){for(let t=0,e=F.length;t<e;++t){const e=F[t],s=(0,_.Fj)(e,x);i.loadFeatures(s,(0,_.on)(m,x),k)}L=(0,_.WO)(k,x)}else for(let t=0,e=F.length;t<e;++t)i.loadFeatures(F[t],m,x);const b=(0,d.se)(m,y);let A=!0;const O=t=>{let i;const s=t.getStyleFunction()||e.getStyleFunction();if(s&&(i=s(t,m)),i){const e=this.renderFeature(t,b,i,w,L,D);A=A&&!e}},Z=(0,_.Fj)(C,x),M=i.getFeaturesInExtent(Z);v&&M.sort(v);for(let t=0,e=M.length;t<e;++t)O(M[t]);this.renderedFeatures_=M,this.ready=A;const P=w.finish(),G=new o.Z(C,m,y,i.getOverlaps(),P,e.getRenderBuffer());return D&&(this.declutterExecutorGroup=new o.Z(C,m,y,i.getOverlaps(),D.finish(),e.getRenderBuffer())),this.renderedResolution_=m,this.renderedRevision_=S,this.renderedRenderOrder_=v,this.renderedExtent_=R,this.wrappedRenderedExtent_=C,this.renderedCenter_=I,this.renderedProjection_=x,this.replayGroup_=G,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(t,e,i,s,n,r){if(!i)return!1;let o=!1;if(Array.isArray(i))for(let h=0,a=i.length;h<a;++h)o=(0,d.Pn)(s,t,i[h],e,this.boundHandleStyleImageChange_,n,r)||o;else o=(0,d.Pn)(s,t,i,e,this.boundHandleStyleImageChange_,n,r);return o}}const m=x;class y extends s.Z{constructor(t){super(t)}createRenderer(){return new m(this)}}const S=y},880161:(t,e,i)=>{"use strict";i.d(e,{$6:()=>n,VW:()=>r,Gg:()=>o});var s=i(218672);function n(t,e){return[[-1/0,-1/0,1/0,1/0]]}function r(t,e){return[t]}function o(t){return function(e,i,n){const r=t.getZForResolution((0,s.oK)(i,n)),o=t.getTileRangeForExtentAndZ((0,s.dY)(e,n),r),h=[],a=[r,0,0];for(a[1]=o.minX;a[1]<=o.maxX;++a[1])for(a[2]=o.minY;a[2]<=o.maxY;++a[2])h.push((0,s.Fj)(t.getTileCoordExtent(a),n));return h}}},180567:(t,e,i)=>{"use strict";i.d(e,{Z:()=>d});var s=i(168186),n=i(434178),r=i(764889),o=i(545120),h=i(421915),a=i(968509),l=i(179682),c=i(686204);class u extends r.Z{constructor(t,e,i,s){super(),this.tolerance=t,this.maxExtent=e,this.pixelRatio=s,this.maxLineWidth=0,this.resolution=i,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(t){const e=this.pixelRatio;return 1==e?t:t.map((function(t){return t*e}))}appendFlatPointCoordinates(t,e){const i=this.getBufferedMaxExtent(),s=this.tmpCoordinate_,n=this.coordinates;let r=n.length;for(let o=0,a=t.length;o<a;o+=e)s[0]=t[o],s[1]=t[o+1],(0,h.b8)(i,s)&&(n[r++]=s[0],n[r++]=s[1]);return r}appendFlatLineCoordinates(t,e,i,s,r,o){const a=this.coordinates;let l=a.length;const c=this.getBufferedMaxExtent();o&&(e+=s);let u=t[e],d=t[e+1];const g=this.tmpCoordinate_;let _,f,p,x=!0;for(_=e+s;_<i;_+=s)g[0]=t[_],g[1]=t[_+1],p=(0,h.pX)(c,g),p!==f?(x&&(a[l++]=u,a[l++]=d,x=!1),a[l++]=g[0],a[l++]=g[1]):p===n.Z.INTERSECTING?(a[l++]=g[0],a[l++]=g[1],x=!1):x=!0,u=g[0],d=g[1],f=p;return(r&&x||_===e+s)&&(a[l++]=u,a[l++]=d),l}drawCustomCoordinates_(t,e,i,s,n){for(let r=0,o=i.length;r<o;++r){const o=i[r],h=this.appendFlatLineCoordinates(t,e,o,s,!1,!1);n.push(h),e=o}return e}drawCustom(t,e,i,n){this.beginGeometry(t,e);const r=t.getType(),o=t.getStride(),h=this.coordinates.length;let a,l,u,d,g;switch(r){case"MultiPolygon":a=t.getOrientedFlatCoordinates(),d=[];const e=t.getEndss();g=0;for(let t=0,i=e.length;t<i;++t){const i=[];g=this.drawCustomCoordinates_(a,g,e[t],o,i),d.push(i)}this.instructions.push([s.ZP.CUSTOM,h,d,t,i,c.ug]),this.hitDetectionInstructions.push([s.ZP.CUSTOM,h,d,t,n||i,c.ug]);break;case"Polygon":case"MultiLineString":u=[],a="Polygon"==r?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),g=this.drawCustomCoordinates_(a,0,t.getEnds(),o,u),this.instructions.push([s.ZP.CUSTOM,h,u,t,i,c.o1]),this.hitDetectionInstructions.push([s.ZP.CUSTOM,h,u,t,n||i,c.o1]);break;case"LineString":case"Circle":a=t.getFlatCoordinates(),l=this.appendFlatLineCoordinates(a,0,a.length,o,!1,!1),this.instructions.push([s.ZP.CUSTOM,h,l,t,i,c.Ml]),this.hitDetectionInstructions.push([s.ZP.CUSTOM,h,l,t,n||i,c.Ml]);break;case"MultiPoint":a=t.getFlatCoordinates(),l=this.appendFlatPointCoordinates(a,o),l>h&&(this.instructions.push([s.ZP.CUSTOM,h,l,t,i,c.Ml]),this.hitDetectionInstructions.push([s.ZP.CUSTOM,h,l,t,n||i,c.Ml]));break;case"Point":a=t.getFlatCoordinates(),this.coordinates.push(a[0],a[1]),l=this.coordinates.length,this.instructions.push([s.ZP.CUSTOM,h,l,t,i]),this.hitDetectionInstructions.push([s.ZP.CUSTOM,h,l,t,n||i])}this.endGeometry(e)}beginGeometry(t,e){this.beginGeometryInstruction1_=[s.ZP.BEGIN_GEOMETRY,e,0,t],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[s.ZP.BEGIN_GEOMETRY,e,0,t],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const t=this.hitDetectionInstructions;let e;t.reverse();const i=t.length;let n,r,o=-1;for(e=0;e<i;++e)n=t[e],r=n[0],r==s.ZP.END_GEOMETRY?o=e:r==s.ZP.BEGIN_GEOMETRY&&(n[2]=e,(0,l.FZ)(this.hitDetectionInstructions,o,e),o=-1)}setFillStrokeStyle(t,e){const i=this.state;if(t){const e=t.getColor();i.fillStyle=(0,o.y)(e||a.bL)}else i.fillStyle=void 0;if(e){const t=e.getColor();i.strokeStyle=(0,o.y)(t||a.Tx);const s=e.getLineCap();i.lineCap=void 0!==s?s:a.mb;const n=e.getLineDash();i.lineDash=n?n.slice():a.X9;const r=e.getLineDashOffset();i.lineDashOffset=r||a.He;const h=e.getLineJoin();i.lineJoin=void 0!==h?h:a.rc;const l=e.getWidth();i.lineWidth=void 0!==l?l:a.yC;const c=e.getMiterLimit();i.miterLimit=void 0!==c?c:a.V4,i.lineWidth>this.maxLineWidth&&(this.maxLineWidth=i.lineWidth,this.bufferedMaxExtent_=null)}else i.strokeStyle=void 0,i.lineCap=void 0,i.lineDash=null,i.lineDashOffset=void 0,i.lineJoin=void 0,i.lineWidth=void 0,i.miterLimit=void 0}createFill(t){const e=t.fillStyle,i=[s.ZP.SET_FILL_STYLE,e];return"string"!=typeof e&&i.push(!0),i}applyStroke(t){this.instructions.push(this.createStroke(t))}createStroke(t){return[s.ZP.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio]}updateFillStyle(t,e){const i=t.fillStyle;"string"==typeof i&&t.currentFillStyle==i||(void 0!==i&&this.instructions.push(e.call(this,t)),t.currentFillStyle=i)}updateStrokeStyle(t,e){const i=t.strokeStyle,s=t.lineCap,n=t.lineDash,r=t.lineDashOffset,o=t.lineJoin,h=t.lineWidth,a=t.miterLimit;(t.currentStrokeStyle!=i||t.currentLineCap!=s||n!=t.currentLineDash&&!(0,l.fS)(t.currentLineDash,n)||t.currentLineDashOffset!=r||t.currentLineJoin!=o||t.currentLineWidth!=h||t.currentMiterLimit!=a)&&(void 0!==i&&e.call(this,t),t.currentStrokeStyle=i,t.currentLineCap=s,t.currentLineDash=n,t.currentLineDashOffset=r,t.currentLineJoin=o,t.currentLineWidth=h,t.currentMiterLimit=a)}endGeometry(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const e=[s.ZP.END_GEOMETRY,t];this.instructions.push(e),this.hitDetectionInstructions.push(e)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=(0,h.d9)(this.maxExtent),this.maxLineWidth>0)){const t=this.resolution*(this.maxLineWidth+1)/2;(0,h.f3)(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}const d=u},95965:(t,e,i)=>{"use strict";i.d(e,{Z:()=>f});var s=i(180567),n=i(168186);class r extends s.Z{constructor(t,e,i,s){super(t,e,i,s),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(t,e){if(!this.image_)return;this.beginGeometry(t,e);const i=t.getFlatCoordinates(),s=t.getStride(),r=this.coordinates.length,o=this.appendFlatPointCoordinates(i,s);this.instructions.push([n.ZP.DRAW_IMAGE,r,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([n.ZP.DRAW_IMAGE,r,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}drawMultiPoint(t,e){if(!this.image_)return;this.beginGeometry(t,e);const i=t.getFlatCoordinates(),s=t.getStride(),r=this.coordinates.length,o=this.appendFlatPointCoordinates(i,s);this.instructions.push([n.ZP.DRAW_IMAGE,r,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([n.ZP.DRAW_IMAGE,r,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(t,e){const i=t.getAnchor(),s=t.getSize(),n=t.getOrigin();this.imagePixelRatio_=t.getPixelRatio(this.pixelRatio),this.anchorX_=i[0],this.anchorY_=i[1],this.hitDetectionImage_=t.getHitDetectionImage(),this.image_=t.getImage(this.pixelRatio),this.height_=s[1],this.opacity_=t.getOpacity(),this.originX_=n[0],this.originY_=n[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScaleArray(),this.width_=s[0],this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}}const o=r;var h=i(968509);class a extends s.Z{constructor(t,e,i,s){super(t,e,i,s)}drawFlatCoordinates_(t,e,i,s){const r=this.coordinates.length,o=this.appendFlatLineCoordinates(t,e,i,s,!1,!1),h=[n.ZP.MOVE_TO_LINE_TO,r,o];return this.instructions.push(h),this.hitDetectionInstructions.push(h),i}drawLineString(t,e){const i=this.state,s=i.strokeStyle,r=i.lineWidth;if(void 0===s||void 0===r)return;this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([n.ZP.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,h.X9,h.He],n.$O);const o=t.getFlatCoordinates(),a=t.getStride();this.drawFlatCoordinates_(o,0,o.length,a),this.hitDetectionInstructions.push(n.Yc),this.endGeometry(e)}drawMultiLineString(t,e){const i=this.state,s=i.strokeStyle,r=i.lineWidth;if(void 0===s||void 0===r)return;this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([n.ZP.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset],n.$O);const o=t.getEnds(),h=t.getFlatCoordinates(),a=t.getStride();let l=0;for(let t=0,e=o.length;t<e;++t)l=this.drawFlatCoordinates_(h,l,o[t],a);this.hitDetectionInstructions.push(n.Yc),this.endGeometry(e)}finish(){const t=this.state;return null!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&this.instructions.push(n.Yc),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(t){null!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&(this.instructions.push(n.Yc),t.lastStroke=this.coordinates.length),t.lastStroke=0,super.applyStroke(t),this.instructions.push(n.$O)}}const l=a;var c=i(862418);class u extends s.Z{constructor(t,e,i,s){super(t,e,i,s)}drawFlatCoordinatess_(t,e,i,s){const r=this.state,o=void 0!==r.fillStyle,h=void 0!==r.strokeStyle,a=i.length;this.instructions.push(n.$O),this.hitDetectionInstructions.push(n.$O);for(let r=0;r<a;++r){const o=i[r],a=this.coordinates.length,l=this.appendFlatLineCoordinates(t,e,o,s,!0,!h),c=[n.ZP.MOVE_TO_LINE_TO,a,l];this.instructions.push(c),this.hitDetectionInstructions.push(c),h&&(this.instructions.push(n.s3),this.hitDetectionInstructions.push(n.s3)),e=o}return o&&(this.instructions.push(n.gO),this.hitDetectionInstructions.push(n.gO)),h&&(this.instructions.push(n.Yc),this.hitDetectionInstructions.push(n.Yc)),e}drawCircle(t,e){const i=this.state,s=i.fillStyle,r=i.strokeStyle;if(void 0===s&&void 0===r)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([n.ZP.SET_FILL_STYLE,h.bL]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([n.ZP.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset]);const o=t.getFlatCoordinates(),a=t.getStride(),l=this.coordinates.length;this.appendFlatLineCoordinates(o,0,o.length,a,!1,!1);const c=[n.ZP.CIRCLE,l];this.instructions.push(n.$O,c),this.hitDetectionInstructions.push(n.$O,c),void 0!==i.fillStyle&&(this.instructions.push(n.gO),this.hitDetectionInstructions.push(n.gO)),void 0!==i.strokeStyle&&(this.instructions.push(n.Yc),this.hitDetectionInstructions.push(n.Yc)),this.endGeometry(e)}drawPolygon(t,e){const i=this.state,s=i.fillStyle,r=i.strokeStyle;if(void 0===s&&void 0===r)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([n.ZP.SET_FILL_STYLE,h.bL]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([n.ZP.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset]);const o=t.getEnds(),a=t.getOrientedFlatCoordinates(),l=t.getStride();this.drawFlatCoordinatess_(a,0,o,l),this.endGeometry(e)}drawMultiPolygon(t,e){const i=this.state,s=i.fillStyle,r=i.strokeStyle;if(void 0===s&&void 0===r)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([n.ZP.SET_FILL_STYLE,h.bL]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([n.ZP.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset]);const o=t.getEndss(),a=t.getOrientedFlatCoordinates(),l=t.getStride();let c=0;for(let t=0,e=o.length;t<e;++t)c=this.drawFlatCoordinatess_(a,c,o[t],l);this.endGeometry(e)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const t=this.tolerance;if(0!==t){const e=this.coordinates;for(let i=0,s=e.length;i<s;++i)e[i]=(0,c.uZ)(e[i],t)}return super.finish()}setFillStrokeStyles_(){const t=this.state;void 0!==t.fillStyle&&this.updateFillStyle(t,this.createFill),void 0!==t.strokeStyle&&this.updateStrokeStyle(t,this.applyStroke)}}const d=u;var g=i(741877);const _={Circle:d,Default:s.Z,Image:o,LineString:l,Polygon:d,Text:g.Z},f=class{constructor(t,e,i,s){this.tolerance_=t,this.maxExtent_=e,this.pixelRatio_=s,this.resolution_=i,this.buildersByZIndex_={}}finish(){const t={};for(const e in this.buildersByZIndex_){t[e]=t[e]||{};const i=this.buildersByZIndex_[e];for(const s in i){const n=i[s].finish();t[e][s]=n}}return t}getBuilder(t,e){const i=void 0!==t?t.toString():"0";let s=this.buildersByZIndex_[i];void 0===s&&(s={},this.buildersByZIndex_[i]=s);let n=s[e];return void 0===n&&(n=new(0,_[e])(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),s[e]=n),n}}},983183:(t,e,i)=>{"use strict";i.d(e,{Z:()=>T});var s=i(168186),n=i(741877),r=i(782359),o=i(421915),h=i(968509),a=i(921882),l=i(517882);function c(t,e,i,s,n,r,o,h,c,u,d,g){let _=t[e],f=t[e+1],p=0,x=0,m=0,y=0;function S(){p=_,x=f,_=t[e+=s],f=t[e+1],y+=m,m=Math.sqrt((_-p)*(_-p)+(f-x)*(f-x))}do{S()}while(e<i-s&&y+m<r);let E=0===m?0:(r-y)/m;const v=(0,a.t7)(p,_,E),I=(0,a.t7)(x,f,E),C=e-s,R=y,F=r+h*c(u,n,d);for(;e<i-s&&y+m<F;)S();E=0===m?0:(F-y)/m;const T=(0,a.t7)(p,_,E),w=(0,a.t7)(x,f,E);let D;if(g){const t=[v,I,T,w];(0,l.U1)(t,0,4,2,g,t,t),D=t[0]>t[2]}else D=v>T;const k=Math.PI,L=[],b=C+s===e;let A;if(m=0,y=R,_=t[e=C],f=t[e+1],b){S(),A=Math.atan2(f-x,_-p),D&&(A+=A>0?-k:k);const t=(T+v)/2,e=(w+I)/2;return L[0]=[t,e,(F-r)/2,A,n],L}for(let t=0,l=(n=n.replace(/\n/g," ")).length;t<l;){S();let g=Math.atan2(f-x,_-p);if(D&&(g+=g>0?-k:k),void 0!==A){let t=g-A;if(t+=t>k?-2*k:t<-k?2*k:0,Math.abs(t)>o)return null}A=g;const v=t;let I=0;for(;t<l;++t){const o=h*c(u,n[D?l-t-1:t],d);if(e+s<i&&y+m<r+I+o/2)break;I+=o}if(t===v)continue;const C=D?n.substring(l-v,l-t):n.substring(v,t);E=0===m?0:(r+I/2-y)/m;const R=(0,a.t7)(p,_,E),F=(0,a.t7)(x,f,E);L.push([R,F,I/2,g,C]),r+=I}return L}var u=i(179682),d=i(804027);const g=(0,o.lJ)(),_=[],f=[],p=[],x=[];function m(t){return t[3].declutterBox}const y=new RegExp("["+String.fromCharCode(1425)+"-"+String.fromCharCode(2303)+String.fromCharCode(64285)+"-"+String.fromCharCode(65023)+String.fromCharCode(65136)+"-"+String.fromCharCode(65276)+String.fromCharCode(67584)+"-"+String.fromCharCode(69631)+String.fromCharCode(124928)+"-"+String.fromCharCode(126975)+"]");function S(t,e){return"start"!==e&&"end"!==e||y.test(t)||(e="start"===e?"left":"right"),n.I[e]}function E(t,e,i){return i>0&&t.push("\n",""),t.push(e,""),t}const v=class{constructor(t,e,i,s){this.overlaps=i,this.pixelRatio=e,this.resolution=t,this.alignFill_,this.instructions=s.instructions,this.coordinates=s.coordinates,this.coordinateCache_={},this.renderedTransform_=(0,r.Ue)(),this.hitDetectionInstructions=s.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=s.fillStates||{},this.strokeStates=s.strokeStates||{},this.textStates=s.textStates||{},this.widths_={},this.labels_={}}createLabel(t,e,i,s){const r=t+e+i+s;if(this.labels_[r])return this.labels_[r];const o=s?this.strokeStates[s]:null,a=i?this.fillStates[i]:null,l=this.textStates[e],c=this.pixelRatio,u=[l.scale[0]*c,l.scale[1]*c],d=Array.isArray(t),g=l.justify?n.I[l.justify]:S(Array.isArray(t)?t[0]:t,l.textAlign||h.PH),_=s&&o.lineWidth?o.lineWidth:0,f=d?t:t.split("\n").reduce(E,[]),{width:p,height:x,widths:m,heights:y,lineWidths:v}=(0,h.Zw)(l,f),I=p+_,C=[],R=(I+2)*u[0],F=(x+_)*u[1],T={width:R<0?Math.floor(R):Math.ceil(R),height:F<0?Math.floor(F):Math.ceil(F),contextInstructions:C};1==u[0]&&1==u[1]||C.push("scale",u),s&&(C.push("strokeStyle",o.strokeStyle),C.push("lineWidth",_),C.push("lineCap",o.lineCap),C.push("lineJoin",o.lineJoin),C.push("miterLimit",o.miterLimit),C.push("setLineDash",[o.lineDash]),C.push("lineDashOffset",o.lineDashOffset)),i&&C.push("fillStyle",a.fillStyle),C.push("textBaseline","middle"),C.push("textAlign","center");const w=.5-g;let D=g*I+w*_;const k=[],L=[];let b,A=0,O=0,Z=0,M=0;for(let t=0,e=f.length;t<e;t+=2){const e=f[t];if("\n"===e){O+=A,A=0,D=g*I+w*_,++M;continue}const n=f[t+1]||l.font;n!==b&&(s&&k.push("font",n),i&&L.push("font",n),b=n),A=Math.max(A,y[Z]);const r=[e,D+w*m[Z]+g*(m[Z]-v[M]),.5*(_+A)+O];D+=m[Z],s&&k.push("strokeText",r),i&&L.push("fillText",r),++Z}return Array.prototype.push.apply(C,k),Array.prototype.push.apply(C,L),this.labels_[r]=T,T}replayTextBackground_(t,e,i,s,n,r,o){t.beginPath(),t.moveTo.apply(t,e),t.lineTo.apply(t,i),t.lineTo.apply(t,s),t.lineTo.apply(t,n),t.lineTo.apply(t,e),r&&(this.alignFill_=r[2],this.fill_(t)),o&&(this.setStrokeStyle_(t,o),t.stroke())}calculateImageOrLabelDimensions_(t,e,i,s,n,h,a,l,c,u,d,m,y,S,E,v){let I=i-(a*=m[0]),C=s-(l*=m[1]);const R=n+c>t?t-c:n,F=h+u>e?e-u:h,T=S[3]+R*m[0]+S[1],w=S[0]+F*m[1]+S[2],D=I-S[3],k=C-S[0];let L;return(E||0!==d)&&(_[0]=D,x[0]=D,_[1]=k,f[1]=k,f[0]=D+T,p[0]=f[0],p[1]=k+w,x[1]=p[1]),0!==d?(L=(0,r.qC)((0,r.Ue)(),i,s,1,1,d,-i,-s),(0,r.nn)(L,_),(0,r.nn)(L,f),(0,r.nn)(L,p),(0,r.nn)(L,x),(0,o.T9)(Math.min(_[0],f[0],p[0],x[0]),Math.min(_[1],f[1],p[1],x[1]),Math.max(_[0],f[0],p[0],x[0]),Math.max(_[1],f[1],p[1],x[1]),g)):(0,o.T9)(Math.min(D,D+T),Math.min(k,k+w),Math.max(D,D+T),Math.max(k,k+w),g),y&&(I=Math.round(I),C=Math.round(C)),{drawImageX:I,drawImageY:C,drawImageW:R,drawImageH:F,originX:c,originY:u,declutterBox:{minX:g[0],minY:g[1],maxX:g[2],maxY:g[3],value:v},canvasTransform:L,scale:m}}replayImageOrLabel_(t,e,i,s,n,r,o){const a=!(!r&&!o),l=s.declutterBox,c=t.canvas,u=o?o[2]*s.scale[0]/2:0;return l.minX-u<=c.width/e&&l.maxX+u>=0&&l.minY-u<=c.height/e&&l.maxY+u>=0&&(a&&this.replayTextBackground_(t,_,f,p,x,r,o),(0,h._f)(t,s.canvasTransform,n,i,s.originX,s.originY,s.drawImageW,s.drawImageH,s.drawImageX,s.drawImageY,s.scale)),!0}fill_(t){if(this.alignFill_){const e=(0,r.nn)(this.renderedTransform_,[0,0]),i=512*this.pixelRatio;t.save(),t.translate(e[0]%i,e[1]%i),t.rotate(this.viewRotation_)}t.fill(),this.alignFill_&&t.restore()}setStrokeStyle_(t,e){t.strokeStyle=e[1],t.lineWidth=e[2],t.lineCap=e[3],t.lineJoin=e[4],t.miterLimit=e[5],t.lineDashOffset=e[7],t.setLineDash(e[6])}drawLabelWithPointPlacement_(t,e,i,s){const r=this.textStates[e],o=this.createLabel(t,e,s,i),a=this.strokeStates[i],l=this.pixelRatio,c=S(Array.isArray(t)?t[0]:t,r.textAlign||h.PH),u=n.I[r.textBaseline||h.ru],d=a&&a.lineWidth?a.lineWidth:0;return{label:o,anchorX:c*(o.width/l-2*r.scale[0])+2*(.5-c)*d,anchorY:u*o.height/l+2*(.5-u)*d}}execute_(t,e,i,a,g,_,f,p){let x;this.pixelCoordinates_&&(0,u.fS)(i,this.renderedTransform_)?x=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),x=(0,l.vT)(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_),(0,r.lk)(this.renderedTransform_,i));let y=0;const S=a.length;let E,v,I,C,R,F,T,w,D,k,L,b,A=0,O=0,Z=0,M=null,P=null;const G=this.coordinateCache_,W=this.viewRotation_,Y=Math.round(1e12*Math.atan2(-i[1],i[0]))/1e12,B={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:W},N=this.instructions!=a||this.overlaps?0:200;let X,U,K,q;for(;y<S;){const i=a[y];switch(i[0]){case s.ZP.BEGIN_GEOMETRY:X=i[1],q=i[3],X.getGeometry()?void 0===f||(0,o.kK)(f,q.getExtent())?++y:y=i[2]+1:y=i[2];break;case s.ZP.BEGIN_PATH:O>N&&(this.fill_(t),O=0),Z>N&&(t.stroke(),Z=0),O||Z||(t.beginPath(),C=NaN,R=NaN),++y;break;case s.ZP.CIRCLE:A=i[1];const r=x[A],a=x[A+1],l=x[A+2]-r,u=x[A+3]-a,S=Math.sqrt(l*l+u*u);t.moveTo(r+S,a),t.arc(r,a,S,0,2*Math.PI,!0),++y;break;case s.ZP.CLOSE_PATH:t.closePath(),++y;break;case s.ZP.CUSTOM:A=i[1],E=i[2];const H=i[3],V=i[4],j=6==i.length?i[5]:void 0;B.geometry=H,B.feature=X,y in G||(G[y]=[]);const J=G[y];j?j(x,A,E,2,J):(J[0]=x[A],J[1]=x[A+1],J.length=2),V(J,B),++y;break;case s.ZP.DRAW_IMAGE:A=i[1],E=i[2],w=i[3],v=i[4],I=i[5];let z=i[6];const $=i[7],Q=i[8],tt=i[9],et=i[10];let it=i[11];const st=i[12];let nt=i[13];const rt=i[14],ot=i[15];if(!w&&i.length>=20){D=i[19],k=i[20],L=i[21],b=i[22];const t=this.drawLabelWithPointPlacement_(D,k,L,b);w=t.label,i[3]=w;const e=i[23];v=(t.anchorX-e)*this.pixelRatio,i[4]=v;const s=i[24];I=(t.anchorY-s)*this.pixelRatio,i[5]=I,z=w.height,i[6]=z,nt=w.width,i[13]=nt}let ht,at,lt,ct;i.length>25&&(ht=i[25]),i.length>17?(at=i[16],lt=i[17],ct=i[18]):(at=h.oB,lt=!1,ct=!1),et&&Y?it+=W:et||Y||(it-=W);let ut=0;for(;A<E;A+=2){if(ht&&ht[ut++]<nt/this.pixelRatio)continue;const i=this.calculateImageOrLabelDimensions_(w.width,w.height,x[A],x[A+1],nt,z,v,I,Q,tt,it,st,g,at,lt||ct,X),s=[t,e,w,i,$,lt?M:null,ct?P:null];if(p){if("none"===rt)continue;if("obstacle"===rt){p.insert(i.declutterBox);continue}{let t,e;if(ot){const i=E-A;if(!ot[i]){ot[i]=s;continue}if(t=ot[i],delete ot[i],e=m(t),p.collides(e))continue}if(p.collides(i.declutterBox))continue;t&&(p.insert(e),this.replayImageOrLabel_.apply(this,t)),p.insert(i.declutterBox)}}this.replayImageOrLabel_.apply(this,s)}++y;break;case s.ZP.DRAW_CHARS:const dt=i[1],gt=i[2],_t=i[3],ft=i[4];b=i[5];const pt=i[6],xt=i[7],mt=i[8];L=i[9];const yt=i[10];D=i[11],k=i[12];const St=[i[13],i[13]],Et=this.textStates[k],vt=Et.font,It=[Et.scale[0]*xt,Et.scale[1]*xt];let Ct;vt in this.widths_?Ct=this.widths_[vt]:(Ct={},this.widths_[vt]=Ct);const Rt=(0,d.W)(x,dt,gt,2),Ft=Math.abs(It[0])*(0,h.Kd)(vt,D,Ct);if(ft||Ft<=Rt){const i=this.textStates[k].textAlign,s=c(x,dt,gt,2,D,(Rt-Ft)*n.I[i],pt,Math.abs(It[0]),h.Kd,vt,Ct,Y?0:this.viewRotation_);t:if(s){const i=[];let n,r,o,a,l;if(L)for(n=0,r=s.length;n<r;++n){l=s[n],o=l[4],a=this.createLabel(o,k,"",L),v=l[2]+(It[0]<0?-yt:yt),I=_t*a.height+2*(.5-_t)*yt*It[1]/It[0]-mt;const r=this.calculateImageOrLabelDimensions_(a.width,a.height,l[0],l[1],a.width,a.height,v,I,0,0,l[3],St,!1,h.oB,!1,X);if(p&&p.collides(r.declutterBox))break t;i.push([t,e,a,r,1,null,null])}if(b)for(n=0,r=s.length;n<r;++n){l=s[n],o=l[4],a=this.createLabel(o,k,b,""),v=l[2],I=_t*a.height-mt;const r=this.calculateImageOrLabelDimensions_(a.width,a.height,l[0],l[1],a.width,a.height,v,I,0,0,l[3],St,!1,h.oB,!1,X);if(p&&p.collides(r.declutterBox))break t;i.push([t,e,a,r,1,null,null])}p&&p.load(i.map(m));for(let t=0,e=i.length;t<e;++t)this.replayImageOrLabel_.apply(this,i[t])}}++y;break;case s.ZP.END_GEOMETRY:if(void 0!==_){X=i[1];const t=_(X,q);if(t)return t}++y;break;case s.ZP.FILL:N?O++:this.fill_(t),++y;break;case s.ZP.MOVE_TO_LINE_TO:for(A=i[1],E=i[2],U=x[A],K=x[A+1],F=U+.5|0,T=K+.5|0,F===C&&T===R||(t.moveTo(U,K),C=F,R=T),A+=2;A<E;A+=2)U=x[A],K=x[A+1],F=U+.5|0,T=K+.5|0,A!=E-2&&F===C&&T===R||(t.lineTo(U,K),C=F,R=T);++y;break;case s.ZP.SET_FILL_STYLE:M=i,this.alignFill_=i[2],O&&(this.fill_(t),O=0,Z&&(t.stroke(),Z=0)),t.fillStyle=i[1],++y;break;case s.ZP.SET_STROKE_STYLE:P=i,Z&&(t.stroke(),Z=0),this.setStrokeStyle_(t,i),++y;break;case s.ZP.STROKE:N?Z++:t.stroke(),++y;break;default:++y}}O&&this.fill_(t),Z&&t.stroke()}execute(t,e,i,s,n,r){this.viewRotation_=s,this.execute_(t,e,i,this.instructions,n,void 0,void 0,r)}executeHitDetection(t,e,i,s,n){return this.viewRotation_=i,this.execute_(t,1,e,this.hitDetectionInstructions,!0,s,n)}};var I=i(85386),C=i(913580);const R=["Polygon","Circle","LineString","Image","Text","Default"],F={},T=class{constructor(t,e,i,s,n,o){this.maxExtent_=t,this.overlaps_=s,this.pixelRatio_=i,this.resolution_=e,this.renderBuffer_=o,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=(0,r.Ue)(),this.createExecutors_(n)}clip(t,e){const i=this.getClipCoords(e);t.beginPath(),t.moveTo(i[0],i[1]),t.lineTo(i[2],i[3]),t.lineTo(i[4],i[5]),t.lineTo(i[6],i[7]),t.clip()}createExecutors_(t){for(const e in t){let i=this.executorsByZIndex_[e];void 0===i&&(i={},this.executorsByZIndex_[e]=i);const s=t[e];for(const t in s){const e=s[t];i[t]=new v(this.resolution_,this.pixelRatio_,this.overlaps_,e)}}}hasExecutors(t){for(const e in this.executorsByZIndex_){const i=this.executorsByZIndex_[e];for(let e=0,s=t.length;e<s;++e)if(t[e]in i)return!0}return!1}forEachFeatureAtCoordinate(t,e,i,s,n,h){const a=2*(s=Math.round(s))+1,l=(0,r.qC)(this.hitDetectionTransform_,s+.5,s+.5,1/e,-1/e,-i,-t[0],-t[1]),c=!this.hitDetectionContext_;c&&(this.hitDetectionContext_=(0,I.E4)(a,a,void 0,{willReadFrequently:!0}));const d=this.hitDetectionContext_;let g;d.canvas.width!==a||d.canvas.height!==a?(d.canvas.width=a,d.canvas.height=a):c||d.clearRect(0,0,a,a),void 0!==this.renderBuffer_&&(g=(0,o.lJ)(),(0,o.Wj)(g,t),(0,o.f3)(g,e*(this.renderBuffer_+s),g));const _=function(t){if(void 0!==F[t])return F[t];const e=2*t+1,i=t*t,s=new Array(i+1);for(let n=0;n<=t;++n)for(let r=0;r<=t;++r){const o=n*n+r*r;if(o>i)break;let h=s[o];h||(h=[],s[o]=h),h.push(4*((t+n)*e+(t+r))+3),n>0&&h.push(4*((t-n)*e+(t+r))+3),r>0&&(h.push(4*((t+n)*e+(t-r))+3),n>0&&h.push(4*((t-n)*e+(t-r))+3))}const n=[];for(let t=0,e=s.length;t<e;++t)s[t]&&n.push(...s[t]);return F[t]=n,n}(s);let f;function p(t,e){const i=d.getImageData(0,0,a,a).data;for(let r=0,o=_.length;r<o;r++)if(i[_[r]]>0){if(!h||"Image"!==f&&"Text"!==f||h.includes(t)){const i=(_[r]-3)/4,o=s-i%a,h=s-(i/a|0),l=n(t,e,o*o+h*h);if(l)return l}d.clearRect(0,0,a,a);break}}const x=Object.keys(this.executorsByZIndex_).map(Number);let m,y,S,E,v;for(x.sort(u.j2),m=x.length-1;m>=0;--m){const t=x[m].toString();for(S=this.executorsByZIndex_[t],y=R.length-1;y>=0;--y)if(f=R[y],E=S[f],void 0!==E&&(v=E.executeHitDetection(d,l,i,p,g),v))return v}}getClipCoords(t){const e=this.maxExtent_;if(!e)return null;const i=e[0],s=e[1],n=e[2],r=e[3],o=[i,s,i,r,n,r,n,s];return(0,l.vT)(o,0,8,2,t,o),o}isEmpty(){return(0,C.x)(this.executorsByZIndex_)}execute(t,e,i,s,n,r,o){const h=Object.keys(this.executorsByZIndex_).map(Number);let a,l,c,d,g,_;for(h.sort(u.j2),this.maxExtent_&&(t.save(),this.clip(t,i)),r=r||R,o&&h.reverse(),a=0,l=h.length;a<l;++a){const l=h[a].toString();for(g=this.executorsByZIndex_[l],c=0,d=r.length;c<d;++c)_=g[r[c]],void 0!==_&&_.execute(t,e,i,s,n,o)}this.maxExtent_&&t.restore()}}},168186:(t,e,i)=>{"use strict";i.d(e,{gO:()=>n,Yc:()=>r,$O:()=>o,s3:()=>h,ZP:()=>a});const s={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},n=[s.FILL],r=[s.STROKE],o=[s.BEGIN_PATH],h=[s.CLOSE_PATH],a=s},741877:(t,e,i)=>{"use strict";i.d(e,{I:()=>d,Z:()=>_});var s=i(180567),n=i(168186),r=i(545120),o=i(968509),h=i(949179),a=i(421915),l=i(921882);function c(t,e,i,s,n){const r=[];let o=i,h=0,a=e.slice(i,2);for(;h<t&&o+n<s;){const[i,s]=a.slice(-2),c=e[o+n],u=e[o+n+1],d=Math.sqrt((c-i)*(c-i)+(u-s)*(u-s));if(h+=d,h>=t){const e=(t-h+d)/d,g=(0,l.t7)(i,c,e),_=(0,l.t7)(s,u,e);a.push(g,_),r.push(a),a=[g,_],h==t&&(o+=n),h=0}else if(h<t)a.push(e[o+n],e[o+n+1]),o+=n;else{const t=d-h,e=(0,l.t7)(i,c,t/d),g=(0,l.t7)(s,u,t/d);a.push(e,g),r.push(a),a=[e,g],h=0,o+=n}}return h>0&&r.push(a),r}function u(t,e,i,s,n){let r,o,h,a,l,c,u,d,g,_,f=i,p=i,x=0,m=0,y=i;for(o=i;o<s;o+=n){const i=e[o],s=e[o+1];void 0!==l&&(g=i-l,_=s-c,a=Math.sqrt(g*g+_*_),void 0!==u&&(m+=h,r=Math.acos((u*g+d*_)/(h*a)),r>t&&(m>x&&(x=m,f=y,p=o),m=0,y=o-n)),h=a,u=g,d=_),l=i,c=s}return m+=a,m>x?[y,o]:[f,p]}const d={left:0,end:0,center:.5,right:1,start:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class g extends s.Z{constructor(t,e,i,s){super(t,e,i,s),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterImageWithText_=void 0}finish(){const t=super.finish();return t.textStates=this.textStates,t.fillStates=this.fillStates,t.strokeStates=this.strokeStates,t}drawText(t,e){const i=this.textFillState_,s=this.textStrokeState_,r=this.textState_;if(""===this.text_||!r||!i&&!s)return;const h=this.coordinates;let l=h.length;const d=t.getType();let g=null,_=t.getStride();if("line"!==r.placement||"LineString"!=d&&"MultiLineString"!=d&&"Polygon"!=d&&"MultiPolygon"!=d){let i=r.overflow?null:[];switch(d){case"Point":case"MultiPoint":g=t.getFlatCoordinates();break;case"LineString":g=t.getFlatMidpoint();break;case"Circle":g=t.getCenter();break;case"MultiLineString":g=t.getFlatMidpoints(),_=2;break;case"Polygon":g=t.getFlatInteriorPoint(),r.overflow||i.push(g[2]/this.resolution),_=3;break;case"MultiPolygon":const e=t.getFlatInteriorPoints();g=[];for(let t=0,s=e.length;t<s;t+=3)r.overflow||i.push(e[t+2]/this.resolution),g.push(e[t],e[t+1]);if(0===g.length)return;_=2}const s=this.appendFlatPointCoordinates(g,_);if(s===l)return;if(i&&(s-l)/2!=g.length/_){let t=l/2;i=i.filter(((e,i)=>{const s=h[2*(t+i)]===g[i*_]&&h[2*(t+i)+1]===g[i*_+1];return s||--t,s}))}this.saveTextStates_(),(r.backgroundFill||r.backgroundStroke)&&(this.setFillStrokeStyle(r.backgroundFill,r.backgroundStroke),r.backgroundFill&&(this.updateFillStyle(this.state,this.createFill),this.hitDetectionInstructions.push(this.createFill(this.state))),r.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(t,e);let a=r.padding;if(a!=o.oB&&(r.scale[0]<0||r.scale[1]<0)){let t=r.padding[0],e=r.padding[1],i=r.padding[2],s=r.padding[3];r.scale[0]<0&&(e=-e,s=-s),r.scale[1]<0&&(t=-t,i=-i),a=[t,e,i,s]}const c=this.pixelRatio;this.instructions.push([n.ZP.DRAW_IMAGE,l,s,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,void 0,this.declutterImageWithText_,a==o.oB?o.oB:a.map((function(t){return t*c})),!!r.backgroundFill,!!r.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,i]);const u=1/c;this.hitDetectionInstructions.push([n.ZP.DRAW_IMAGE,l,s,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[u,u],NaN,void 0,this.declutterImageWithText_,a,!!r.backgroundFill,!!r.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,i]),this.endGeometry(e)}else{if(!(0,a.kK)(this.getBufferedMaxExtent(),t.getExtent()))return;let i;if(g=t.getFlatCoordinates(),"LineString"==d)i=[g.length];else if("MultiLineString"==d)i=t.getEnds();else if("Polygon"==d)i=t.getEnds().slice(0,1);else if("MultiPolygon"==d){const e=t.getEndss();i=[];for(let t=0,s=e.length;t<s;++t)i.push(e[t][0])}this.beginGeometry(t,e);const s=r.repeat,n=s?void 0:r.textAlign;let o=0;for(let t=0,e=i.length;t<e;++t){let e;e=s?c(s*this.resolution,g,o,i[t],_):[g.slice(o,i[t])];for(let s=0,a=e.length;s<a;++s){const a=e[s];let c=0,d=a.length;if(null==n){const t=u(r.maxAngle,a,0,a.length,2);c=t[0],d=t[1]}for(let t=c;t<d;t+=_)h.push(a[t],a[t+1]);const g=h.length;o=i[t],this.drawChars_(l,g),l=g}}this.endGeometry(e)}}saveTextStates_(){const t=this.textStrokeState_,e=this.textState_,i=this.textFillState_,s=this.strokeKey_;t&&(s in this.strokeStates||(this.strokeStates[s]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}));const n=this.textKey_;n in this.textStates||(this.textStates[n]={font:e.font,textAlign:e.textAlign||o.PH,justify:e.justify,textBaseline:e.textBaseline||o.ru,scale:e.scale});const r=this.fillKey_;i&&(r in this.fillStates||(this.fillStates[r]={fillStyle:i.fillStyle}))}drawChars_(t,e){const i=this.textStrokeState_,s=this.textState_,r=this.strokeKey_,o=this.textKey_,h=this.fillKey_;this.saveTextStates_();const a=this.pixelRatio,l=d[s.textBaseline],c=this.textOffsetY_*a,u=this.text_,g=i?i.lineWidth*Math.abs(s.scale[0])/2:0;this.instructions.push([n.ZP.DRAW_CHARS,t,e,l,s.overflow,h,s.maxAngle,a,c,r,g*a,u,o,1]),this.hitDetectionInstructions.push([n.ZP.DRAW_CHARS,t,e,l,s.overflow,h,s.maxAngle,1,c,r,g,u,o,1/a])}setTextStyle(t,e){let i,s,n;if(t){const e=t.getFill();e?(s=this.textFillState_,s||(s={},this.textFillState_=s),s.fillStyle=(0,r.y)(e.getColor()||o.bL)):(s=null,this.textFillState_=s);const a=t.getStroke();if(a){n=this.textStrokeState_,n||(n={},this.textStrokeState_=n);const t=a.getLineDash(),e=a.getLineDashOffset(),i=a.getWidth(),s=a.getMiterLimit();n.lineCap=a.getLineCap()||o.mb,n.lineDash=t?t.slice():o.X9,n.lineDashOffset=void 0===e?o.He:e,n.lineJoin=a.getLineJoin()||o.rc,n.lineWidth=void 0===i?o.yC:i,n.miterLimit=void 0===s?o.V4:s,n.strokeStyle=(0,r.y)(a.getColor()||o.Tx)}else n=null,this.textStrokeState_=n;i=this.textState_;const l=t.getFont()||o.Df;(0,o.Qx)(l);const c=t.getScaleArray();i.overflow=t.getOverflow(),i.font=l,i.maxAngle=t.getMaxAngle(),i.placement=t.getPlacement(),i.textAlign=t.getTextAlign(),i.repeat=t.getRepeat(),i.justify=t.getJustify(),i.textBaseline=t.getTextBaseline()||o.ru,i.backgroundFill=t.getBackgroundFill(),i.backgroundStroke=t.getBackgroundStroke(),i.padding=t.getPadding()||o.oB,i.scale=void 0===c?[1,1]:c;const u=t.getOffsetX(),d=t.getOffsetY(),g=t.getRotateWithView(),_=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=void 0===u?0:u,this.textOffsetY_=void 0===d?0:d,this.textRotateWithView_=void 0!==g&&g,this.textRotation_=void 0===_?0:_,this.strokeKey_=n?("string"==typeof n.strokeStyle?n.strokeStyle:(0,h.sq)(n.strokeStyle))+n.lineCap+n.lineDashOffset+"|"+n.lineWidth+n.lineJoin+n.miterLimit+"["+n.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.repeat||"?")+(i.justify||"?")+(i.textBaseline||"?"),this.fillKey_=s?"string"==typeof s.fillStyle?s.fillStyle:"|"+(0,h.sq)(s.fillStyle):""}else this.text_="";this.declutterImageWithText_=e}}const _=g},617356:(t,e,i)=>{"use strict";i.d(e,{UN:()=>l,TU:()=>c,ix:()=>u});var s=i(576798),n=i(639166),r=i(179682),o=i(921882),h=i(85386),a=i(421915);const l=.5;function c(t,e,i,o,c,u,d){const g=t[0]*l,_=t[1]*l,f=(0,h.E4)(g,_);f.imageSmoothingEnabled=!1;const p=f.canvas,x=new s.Z(f,l,c,null,d),m=i.length,y=Math.floor(16777215/m),S={};for(let t=1;t<=m;++t){const e=i[t-1],s=e.getStyleFunction()||o;if(!o)continue;let r=s(e,u);if(!r)continue;Array.isArray(r)||(r=[r]);const l=(t*y).toString(16).padStart(7,"#00000");for(let t=0,i=r.length;t<i;++t){const i=r[t],s=i.getGeometryFunction()(e);if(!s||!(0,a.kK)(c,s.getExtent()))continue;const o=i.clone(),u=o.getFill();u&&u.setColor(l);const d=o.getStroke();d&&(d.setColor(l),d.setLineDash(null)),o.setText(void 0);const g=i.getImage();if(g&&0!==g.getOpacity()){const t=g.getImageSize();if(!t)continue;const e=(0,h.E4)(t[0],t[1],void 0,{alpha:!1}),i=e.canvas;e.fillStyle=l,e.fillRect(0,0,i.width,i.height),o.setImage(new n.Z({img:i,imgSize:t,anchor:g.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:g.getOrigin(),opacity:1,size:g.getSize(),scale:g.getScale(),rotation:g.getRotation(),rotateWithView:g.getRotateWithView()}))}const _=o.getZIndex()||0;let f=S[_];f||(f={},S[_]=f,f.Polygon=[],f.Circle=[],f.LineString=[],f.Point=[]);const p=s.getType();if("GeometryCollection"===p){const t=s.getGeometriesArrayRecursive();for(let e=0,i=t.length;e<i;++e){const i=t[e];f[i.getType().replace("Multi","")].push(i,o)}}else f[p.replace("Multi","")].push(s,o)}}const E=Object.keys(S).map(Number).sort(r.j2);for(let t=0,i=E.length;t<i;++t){const i=S[E[t]];for(const t in i){const s=i[t];for(let t=0,i=s.length;t<i;t+=2){x.setStyle(s[t+1]);for(let i=0,n=e.length;i<n;++i)x.setTransform(e[i]),x.drawGeometry(s[t])}}}return f.getImageData(0,0,p.width,p.height)}function u(t,e,i){const s=[];if(i){const n=Math.floor(Math.round(t[0])*l),r=Math.floor(Math.round(t[1])*l),h=4*((0,o.uZ)(n,0,i.width-1)+(0,o.uZ)(r,0,i.height-1)*i.width),a=i.data[h],c=i.data[h+1],u=i.data[h+2]+256*(c+256*a),d=Math.floor(16777215/e.length);u&&u%d==0&&s.push(e[u/d-1])}return s}},973410:(t,e,i)=>{"use strict";i.d(e,{Z:()=>v});var s=i(378426),n=i(919629),r=i(9520),o=i(173381),h=i(713910),a=i(273101),l=i(771405),c=i(925753),u=i(864011),d=i(880161),g=i(438906),_=i(421915),f=i(179682),p=i(949179),x=i(913580),m=i(613002),y=i(280800);class S extends r.ZP{constructor(t,e,i){super(t),this.feature=e,this.features=i}}class E extends l.Z{constructor(t){super({attributions:(t=t||{}).attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:void 0===t.wrapX||t.wrapX}),this.on,this.once,this.un,this.loader_=u.Zn,this.format_=t.format,this.overlaps_=void 0===t.overlaps||t.overlaps,this.url_=t.url,void 0!==t.loader?this.loader_=t.loader:void 0!==this.url_&&((0,g.h)(this.format_,7),this.loader_=(0,y.Be)(this.url_,this.format_)),this.strategy_=void 0!==t.strategy?t.strategy:d.$6;const e=void 0===t.useSpatialIndex||t.useSpatialIndex;let i,n;this.featuresRtree_=e?new a.Z:null,this.loadedExtentsRtree_=new a.Z,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null,Array.isArray(t.features)?n=t.features:t.features&&(i=t.features,n=i.getArray()),e||void 0!==i||(i=new s.Z(n)),void 0!==n&&this.addFeaturesInternal(n),void 0!==i&&this.bindFeaturesCollection_(i)}addFeature(t){this.addFeatureInternal(t),this.changed()}addFeatureInternal(t){const e=(0,p.sq)(t);if(!this.addToIndex_(e,t))return void(this.featuresCollection_&&this.featuresCollection_.remove(t));this.setupChangeEvents_(e,t);const i=t.getGeometry();if(i){const e=i.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(e,t)}else this.nullGeometryFeatures_[e]=t;this.dispatchEvent(new S(c.Z.ADDFEATURE,t))}setupChangeEvents_(t,e){this.featureChangeKeys_[t]=[(0,m.oL)(e,o.Z.CHANGE,this.handleFeatureChange_,this),(0,m.oL)(e,h.Z.PROPERTYCHANGE,this.handleFeatureChange_,this)]}addToIndex_(t,e){let i=!0;const s=e.getId();return void 0!==s&&(s.toString()in this.idIndex_?i=!1:this.idIndex_[s.toString()]=e),i&&((0,g.h)(!(t in this.uidIndex_),30),this.uidIndex_[t]=e),i}addFeatures(t){this.addFeaturesInternal(t),this.changed()}addFeaturesInternal(t){const e=[],i=[],s=[];for(let e=0,s=t.length;e<s;e++){const s=t[e],n=(0,p.sq)(s);this.addToIndex_(n,s)&&i.push(s)}for(let t=0,n=i.length;t<n;t++){const n=i[t],r=(0,p.sq)(n);this.setupChangeEvents_(r,n);const o=n.getGeometry();if(o){const t=o.getExtent();e.push(t),s.push(n)}else this.nullGeometryFeatures_[r]=n}if(this.featuresRtree_&&this.featuresRtree_.load(e,s),this.hasListener(c.Z.ADDFEATURE))for(let t=0,e=i.length;t<e;t++)this.dispatchEvent(new S(c.Z.ADDFEATURE,i[t]))}bindFeaturesCollection_(t){let e=!1;this.addEventListener(c.Z.ADDFEATURE,(function(i){e||(e=!0,t.push(i.feature),e=!1)})),this.addEventListener(c.Z.REMOVEFEATURE,(function(i){e||(e=!0,t.remove(i.feature),e=!1)})),t.addEventListener(n.Z.ADD,(t=>{e||(e=!0,this.addFeature(t.element),e=!1)})),t.addEventListener(n.Z.REMOVE,(t=>{e||(e=!0,this.removeFeature(t.element),e=!1)})),this.featuresCollection_=t}clear(t){if(t){for(const t in this.featureChangeKeys_)this.featureChangeKeys_[t].forEach(m.bN);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){const t=t=>{this.removeFeatureInternal(t)};this.featuresRtree_.forEach(t);for(const t in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[t])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const e=new S(c.Z.CLEAR);this.dispatchEvent(e),this.changed()}forEachFeature(t){if(this.featuresRtree_)return this.featuresRtree_.forEach(t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureAtCoordinateDirect(t,e){const i=[t[0],t[1],t[0],t[1]];return this.forEachFeatureInExtent(i,(function(i){if(i.getGeometry().intersectsCoordinate(t))return e(i)}))}forEachFeatureInExtent(t,e){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(t,e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureIntersectingExtent(t,e){return this.forEachFeatureInExtent(t,(function(i){if(i.getGeometry().intersectsExtent(t)){const t=e(i);if(t)return t}}))}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let t;return this.featuresCollection_?t=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(t=this.featuresRtree_.getAll(),(0,x.x)(this.nullGeometryFeatures_)||(0,f.l7)(t,Object.values(this.nullGeometryFeatures_))),t}getFeaturesAtCoordinate(t){const e=[];return this.forEachFeatureAtCoordinateDirect(t,(function(t){e.push(t)})),e}getFeaturesInExtent(t,e){if(this.featuresRtree_){if(!(e&&e.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(t);const i=(0,_.MV)(t,e);return[].concat(...i.map((t=>this.featuresRtree_.getInExtent(t))))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(t,e){const i=t[0],s=t[1];let n=null;const r=[NaN,NaN];let o=1/0;const h=[-1/0,-1/0,1/0,1/0];return e=e||u.uX,this.featuresRtree_.forEachInExtent(h,(function(t){if(e(t)){const e=t.getGeometry(),a=o;if(o=e.closestPointXY(i,s,r,o),o<a){n=t;const e=Math.sqrt(o);h[0]=i-e,h[1]=s-e,h[2]=i+e,h[3]=s+e}}})),n}getExtent(t){return this.featuresRtree_.getExtent(t)}getFeatureById(t){const e=this.idIndex_[t.toString()];return void 0!==e?e:null}getFeatureByUid(t){const e=this.uidIndex_[t];return void 0!==e?e:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(t){const e=t.target,i=(0,p.sq)(e),s=e.getGeometry();if(s){const t=s.getExtent();i in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[i],this.featuresRtree_&&this.featuresRtree_.insert(t,e)):this.featuresRtree_&&this.featuresRtree_.update(t,e)}else i in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(e),this.nullGeometryFeatures_[i]=e);const n=e.getId();if(void 0!==n){const t=n.toString();this.idIndex_[t]!==e&&(this.removeFromIdIndex_(e),this.idIndex_[t]=e)}else this.removeFromIdIndex_(e),this.uidIndex_[i]=e;this.changed(),this.dispatchEvent(new S(c.Z.CHANGEFEATURE,e))}hasFeature(t){const e=t.getId();return void 0!==e?e in this.idIndex_:(0,p.sq)(t)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&(0,x.x)(this.nullGeometryFeatures_):!this.featuresCollection_||0===this.featuresCollection_.getLength()}loadFeatures(t,e,i){const s=this.loadedExtentsRtree_,n=this.strategy_(t,e,i);for(let t=0,r=n.length;t<r;++t){const r=n[t];s.forEachInExtent(r,(function(t){return(0,_.r4)(t.extent,r)}))||(++this.loadingExtentsCount_,this.dispatchEvent(new S(c.Z.FEATURESLOADSTART)),this.loader_.call(this,r,e,i,(t=>{--this.loadingExtentsCount_,this.dispatchEvent(new S(c.Z.FEATURESLOADEND,void 0,t))}),(()=>{--this.loadingExtentsCount_,this.dispatchEvent(new S(c.Z.FEATURESLOADERROR))})),s.insert(r,{extent:r.slice()}))}this.loading=!(this.loader_.length<4)&&this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(t){const e=this.loadedExtentsRtree_;let i;e.forEachInExtent(t,(function(e){if((0,_.fS)(e.extent,t))return i=e,!0})),i&&e.remove(i)}removeFeature(t){if(!t)return;const e=(0,p.sq)(t);e in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[e]:this.featuresRtree_&&this.featuresRtree_.remove(t),this.removeFeatureInternal(t)&&this.changed()}removeFeatureInternal(t){const e=(0,p.sq)(t),i=this.featureChangeKeys_[e];if(!i)return;i.forEach(m.bN),delete this.featureChangeKeys_[e];const s=t.getId();return void 0!==s&&delete this.idIndex_[s.toString()],delete this.uidIndex_[e],this.dispatchEvent(new S(c.Z.REMOVEFEATURE,t)),t}removeFromIdIndex_(t){let e=!1;for(const i in this.idIndex_)if(this.idIndex_[i]===t){delete this.idIndex_[i],e=!0;break}return e}setLoader(t){this.loader_=t}setUrl(t){(0,g.h)(this.format_,7),this.url_=t,this.setLoader((0,y.Be)(t,this.format_))}}const v=E},925753:(t,e,i)=>{"use strict";i.d(e,{Z:()=>s});const s={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"}},273101:(t,e,i)=>{"use strict";i.d(e,{Z:()=>h});var s=i(382582),n=i(421915),r=i(949179),o=i(913580);const h=class{constructor(t){this.rbush_=new s(t),this.items_={}}insert(t,e){const i={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};this.rbush_.insert(i),this.items_[(0,r.sq)(e)]=i}load(t,e){const i=new Array(e.length);for(let s=0,n=e.length;s<n;s++){const n=t[s],o=e[s],h={minX:n[0],minY:n[1],maxX:n[2],maxY:n[3],value:o};i[s]=h,this.items_[(0,r.sq)(o)]=h}this.rbush_.load(i)}remove(t){const e=(0,r.sq)(t),i=this.items_[e];return delete this.items_[e],null!==this.rbush_.remove(i)}update(t,e){const i=this.items_[(0,r.sq)(e)],s=[i.minX,i.minY,i.maxX,i.maxY];(0,n.fS)(s,t)||(this.remove(e),this.insert(t,e))}getAll(){return this.rbush_.all().map((function(t){return t.value}))}getInExtent(t){const e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this.rbush_.search(e).map((function(t){return t.value}))}forEach(t){return this.forEach_(this.getAll(),t)}forEachInExtent(t,e){return this.forEach_(this.getInExtent(t),e)}forEach_(t,e){let i;for(let s=0,n=t.length;s<n;s++)if(i=e(t[s]),i)return i;return i}isEmpty(){return(0,o.x)(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(t){const e=this.rbush_.toJSON();return(0,n.T9)(e.minX,e.minY,e.maxX,e.maxY,t)}concat(t){this.rbush_.load(t.rbush_.all());for(const e in t.items_)this.items_[e]=t.items_[e]}}}}]);