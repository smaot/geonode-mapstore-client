(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[95773,82582,65417],{695773:(t,e,r)=>{"use strict";r.d(e,{Z:()=>v});var n=r(583996);function i(t,e,r){if(void 0===r&&(r={}),!t)throw new Error("point is required");if(!e)throw new Error("polygon is required");var i=(0,n.c9)(t),a=(0,n.wA)(e),u=a.type,s=e.bbox,l=a.coordinates;if(s&&!1===function(t,e){return e[0]<=t[0]&&e[1]<=t[1]&&e[2]>=t[0]&&e[3]>=t[1]}(i,s))return!1;"Polygon"===u&&(l=[l]);for(var c=!1,h=0;h<l.length&&!c;h++)if(o(i,l[h][0],r.ignoreBoundary)){for(var f=!1,p=1;p<l[h].length&&!f;)o(i,l[h][p],!r.ignoreBoundary)&&(f=!0),p++;f||(c=!0)}return c}function o(t,e,r){var n=!1;e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]&&(e=e.slice(0,e.length-1));for(var i=0,o=e.length-1;i<e.length;o=i++){var a=e[i][0],u=e[i][1],s=e[o][0],l=e[o][1];if(t[1]*(a-s)+u*(s-t[0])+l*(t[0]-a)==0&&(a-t[0])*(s-t[0])<=0&&(u-t[1])*(l-t[1])<=0)return!r;u>t[1]!=l>t[1]&&t[0]<(s-a)*(t[1]-u)/(l-u)+a&&(n=!n)}return n}var a=r(640271),u=r(892322);const s=function(t){if(!t)throw new Error("geojson is required");var e=[];return(0,u.nG)(t,(function(t){!function(t,e){var r=[],i=t.geometry;if(null!==i){switch(i.type){case"Polygon":r=(0,n.r7)(i);break;case"LineString":r=[(0,n.r7)(i)]}r.forEach((function(r){var n=function(t,e){var r=[];return t.reduce((function(t,n){var i,o,u,s,l,c,h=(0,a.Tu)([t,n],e);return h.bbox=(o=n,u=(i=t)[0],s=i[1],[u<(l=o[0])?u:l,s<(c=o[1])?s:c,u>l?u:l,s>c?s:c]),r.push(h),n})),r}(r,t.properties);n.forEach((function(t){t.id=e.length,e.push(t)}))}))}}(t,e)})),(0,a.uf)(e)};var l=r(351787);function c(t,e){var r=(0,n.r7)(t),i=(0,n.r7)(e);if(2!==r.length)throw new Error("<intersects> line1 must only contain 2 coordinates");if(2!==i.length)throw new Error("<intersects> line2 must only contain 2 coordinates");var o=r[0][0],u=r[0][1],s=r[1][0],l=r[1][1],c=i[0][0],h=i[0][1],f=i[1][0],p=i[1][1],g=(p-h)*(s-o)-(f-c)*(l-u);if(0===g)return null;var d=((f-c)*(u-h)-(p-h)*(o-c))/g,y=((s-o)*(u-h)-(l-u)*(o-c))/g;if(d>=0&&d<=1&&y>=0&&y<=1){var m=o+d*(s-o),v=u+d*(l-u);return(0,a.xm)([m,v])}return null}const h=function(t,e){var r={},i=[];if("LineString"===t.type&&(t=(0,a.zL)(t)),"LineString"===e.type&&(e=(0,a.zL)(e)),"Feature"===t.type&&"Feature"===e.type&&null!==t.geometry&&null!==e.geometry&&"LineString"===t.geometry.type&&"LineString"===e.geometry.type&&2===t.geometry.coordinates.length&&2===e.geometry.coordinates.length){var o=c(t,e);return o&&i.push(o),(0,a.uf)(i)}var h=l();return h.load(s(e)),(0,u.By)(s(t),(function(t){(0,u.By)(h.search(t),(function(e){var o=c(t,e);if(o){var a=(0,n.r7)(o).join(",");r[a]||(r[a]=!0,i.push(o))}}))})),(0,a.uf)(i)};function f(t,e){void 0===e&&(e={});var r=(0,n.wA)(t);switch(e.properties||"Feature"!==t.type||(e.properties=t.properties),r.type){case"Polygon":return function(t,e){return void 0===e&&(e={}),p((0,n.wA)(t).coordinates,e.properties?e.properties:"Feature"===t.type?t.properties:{})}(r,e);case"MultiPolygon":return function(t,e){void 0===e&&(e={});var r=(0,n.wA)(t).coordinates,i=e.properties?e.properties:"Feature"===t.type?t.properties:{},o=[];return r.forEach((function(t){o.push(p(t,i))})),(0,a.uf)(o)}(r,e);default:throw new Error("invalid poly")}}function p(t,e){return t.length>1?(0,a._R)(t,e):(0,a.Tu)(t[0],e)}function g(t,e){for(var r=0;r<t.coordinates.length-1;r++)if(y(t.coordinates[r],t.coordinates[r+1],e.coordinates))return!0;return!1}function d(t,e){for(var r=0,n=e.coordinates;r<n.length;r++)if(i(n[r],t))return!0;return h(e,f(t)).features.length>0}function y(t,e,r){var n=r[0]-t[0],i=r[1]-t[1],o=e[0]-t[0],a=e[1]-t[1];return 0==n*a-i*o&&(Math.abs(o)>=Math.abs(a)?o>0?t[0]<=r[0]&&r[0]<=e[0]:e[0]<=r[0]&&r[0]<=t[0]:a>0?t[1]<=r[1]&&r[1]<=e[1]:e[1]<=r[1]&&r[1]<=t[1])}const m=function(t,e){var r=!0;return(0,u.nG)(t,(function(t){(0,u.nG)(e,(function(e){if(!1===r)return!1;r=function(t,e){switch(t.type){case"Point":switch(e.type){case"Point":return r=t.coordinates,n=e.coordinates,!(r[0]===n[0]&&r[1]===n[1]);case"LineString":return!g(e,t);case"Polygon":return!i(t,e)}break;case"LineString":switch(e.type){case"Point":return!g(t,e);case"LineString":return!(h(t,e).features.length>0);case"Polygon":return!d(e,t)}break;case"Polygon":switch(e.type){case"Point":return!i(e,t);case"LineString":return!d(t,e);case"Polygon":return!function(t,e){for(var r=0,n=t.coordinates[0];r<n.length;r++)if(i(n[r],e))return!0;for(var o=0,a=e.coordinates[0];o<a.length;o++)if(i(a[o],t))return!0;return h(f(t),f(e)).features.length>0}(e,t)}}var r,n;return!1}(t.geometry,e.geometry)}))})),r};function v(t,e){var r=!1;return(0,u.nG)(t,(function(t){(0,u.nG)(e,(function(e){if(!0===r)return!0;r=!m(t.geometry,e.geometry)}))})),r}},583996:(t,e,r)=>{"use strict";function n(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if("Feature"===t.type&&null!==t.geometry&&"Point"===t.geometry.type)return t.geometry.coordinates;if("Point"===t.type)return t.coordinates}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function i(t){if(Array.isArray(t))return t;if("Feature"===t.type){if(null!==t.geometry)return t.geometry.coordinates}else if(t.coordinates)return t.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function o(t){return"Feature"===t.type?t.geometry:t}r.d(e,{c9:()=>n,r7:()=>i,wA:()=>o}),r(640271)},431540:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(884102);function i(t,e,r){if(null!==t)for(var n,o,a,u,s,l,c,h,f=0,p=0,g=t.type,d="FeatureCollection"===g,y="Feature"===g,m=d?t.features.length:1,v=0;v<m;v++){s=(h=!!(c=d?t.features[v].geometry:y?t.geometry:t)&&"GeometryCollection"===c.type)?c.geometries.length:1;for(var x=0;x<s;x++){var b=0,w=0;if(null!==(u=h?c.geometries[x]:c)){l=u.coordinates;var M=u.type;switch(f=!r||"Polygon"!==M&&"MultiPolygon"!==M?0:1,M){case null:break;case"Point":if(!1===e(l,p,v,b,w))return!1;p++,b++;break;case"LineString":case"MultiPoint":for(n=0;n<l.length;n++){if(!1===e(l[n],p,v,b,w))return!1;p++,"MultiPoint"===M&&b++}"LineString"===M&&b++;break;case"Polygon":case"MultiLineString":for(n=0;n<l.length;n++){for(o=0;o<l[n].length-f;o++){if(!1===e(l[n][o],p,v,b,w))return!1;p++}"MultiLineString"===M&&b++,"Polygon"===M&&w++}"Polygon"===M&&b++;break;case"MultiPolygon":for(n=0;n<l.length;n++){for(w=0,o=0;o<l[n].length;o++){for(a=0;a<l[n][o].length-f;a++){if(!1===e(l[n][o][a],p,v,b,w))return!1;p++}w++}b++}break;case"GeometryCollection":for(n=0;n<u.geometries.length;n++)if(!1===i(u.geometries[n],e,r))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function o(t,e){var r;switch(t.type){case"FeatureCollection":for(r=0;r<t.features.length&&!1!==e(t.features[r].properties,r);r++);break;case"Feature":e(t.properties,0)}}function a(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var r=0;r<t.features.length&&!1!==e(t.features[r],r);r++);}function u(t,e){var r,n,i,o,a,u,s,l,c,h,f=0,p="FeatureCollection"===t.type,g="Feature"===t.type,d=p?t.features.length:1;for(r=0;r<d;r++){for(u=p?t.features[r].geometry:g?t.geometry:t,l=p?t.features[r].properties:g?t.properties:{},c=p?t.features[r].bbox:g?t.bbox:void 0,h=p?t.features[r].id:g?t.id:void 0,a=(s=!!u&&"GeometryCollection"===u.type)?u.geometries.length:1,i=0;i<a;i++)if(null!==(o=s?u.geometries[i]:u))switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(o,f,l,c,h))return!1;break;case"GeometryCollection":for(n=0;n<o.geometries.length;n++)if(!1===e(o.geometries[n],f,l,c,h))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,f,l,c,h))return!1;f++}}function s(t,e){u(t,(function(t,r,i,o,a){var u,s=null===t?null:t.type;switch(s){case null:case"Point":case"LineString":case"Polygon":return!1!==e(n.feature(t,i,{bbox:o,id:a}),r,0)&&void 0}switch(s){case"MultiPoint":u="Point";break;case"MultiLineString":u="LineString";break;case"MultiPolygon":u="Polygon"}for(var l=0;l<t.coordinates.length;l++){var c={type:u,coordinates:t.coordinates[l]};if(!1===e(n.feature(c,i),r,l))return!1}}))}function l(t,e){s(t,(function(t,r,o){var a=0;if(t.geometry){var u=t.geometry.type;if("Point"!==u&&"MultiPoint"!==u){var s,l=0,c=0,h=0;return!1!==i(t,(function(i,u,f,p,g){if(void 0===s||r>l||p>c||g>h)return s=i,l=r,c=p,h=g,void(a=0);var d=n.lineString([s,i],t.properties);if(!1===e(d,r,o,g,a))return!1;a++,s=i}))&&void 0}}}))}function c(t,e){if(!t)throw new Error("geojson is required");s(t,(function(t,r,i){if(null!==t.geometry){var o=t.geometry.type,a=t.geometry.coordinates;switch(o){case"LineString":if(!1===e(t,r,i,0,0))return!1;break;case"Polygon":for(var u=0;u<a.length;u++)if(!1===e(n.lineString(a[u],t.properties),r,i,u))return!1}}}))}e.coordAll=function(t){var e=[];return i(t,(function(t){e.push(t)})),e},e.coordEach=i,e.coordReduce=function(t,e,r,n){var o=r;return i(t,(function(t,n,i,a,u){o=0===n&&void 0===r?t:e(o,t,n,i,a,u)}),n),o},e.featureEach=a,e.featureReduce=function(t,e,r){var n=r;return a(t,(function(t,i){n=0===i&&void 0===r?t:e(n,t,i)})),n},e.findPoint=function(t,e){if(e=e||{},!n.isObject(e))throw new Error("options is invalid");var r,i=e.featureIndex||0,o=e.multiFeatureIndex||0,a=e.geometryIndex||0,u=e.coordIndex||0,s=e.properties;switch(t.type){case"FeatureCollection":i<0&&(i=t.features.length+i),s=s||t.features[i].properties,r=t.features[i].geometry;break;case"Feature":s=s||t.properties,r=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":r=t;break;default:throw new Error("geojson is invalid")}if(null===r)return null;var l=r.coordinates;switch(r.type){case"Point":return n.point(l,s,e);case"MultiPoint":return o<0&&(o=l.length+o),n.point(l[o],s,e);case"LineString":return u<0&&(u=l.length+u),n.point(l[u],s,e);case"Polygon":return a<0&&(a=l.length+a),u<0&&(u=l[a].length+u),n.point(l[a][u],s,e);case"MultiLineString":return o<0&&(o=l.length+o),u<0&&(u=l[o].length+u),n.point(l[o][u],s,e);case"MultiPolygon":return o<0&&(o=l.length+o),a<0&&(a=l[o].length+a),u<0&&(u=l[o][a].length-u),n.point(l[o][a][u],s,e)}throw new Error("geojson is invalid")},e.findSegment=function(t,e){if(e=e||{},!n.isObject(e))throw new Error("options is invalid");var r,i=e.featureIndex||0,o=e.multiFeatureIndex||0,a=e.geometryIndex||0,u=e.segmentIndex||0,s=e.properties;switch(t.type){case"FeatureCollection":i<0&&(i=t.features.length+i),s=s||t.features[i].properties,r=t.features[i].geometry;break;case"Feature":s=s||t.properties,r=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":r=t;break;default:throw new Error("geojson is invalid")}if(null===r)return null;var l=r.coordinates;switch(r.type){case"Point":case"MultiPoint":return null;case"LineString":return u<0&&(u=l.length+u-1),n.lineString([l[u],l[u+1]],s,e);case"Polygon":return a<0&&(a=l.length+a),u<0&&(u=l[a].length+u-1),n.lineString([l[a][u],l[a][u+1]],s,e);case"MultiLineString":return o<0&&(o=l.length+o),u<0&&(u=l[o].length+u-1),n.lineString([l[o][u],l[o][u+1]],s,e);case"MultiPolygon":return o<0&&(o=l.length+o),a<0&&(a=l[o].length+a),u<0&&(u=l[o][a].length-u-1),n.lineString([l[o][a][u],l[o][a][u+1]],s,e)}throw new Error("geojson is invalid")},e.flattenEach=s,e.flattenReduce=function(t,e,r){var n=r;return s(t,(function(t,i,o){n=0===i&&0===o&&void 0===r?t:e(n,t,i,o)})),n},e.geomEach=u,e.geomReduce=function(t,e,r){var n=r;return u(t,(function(t,i,o,a,u){n=0===i&&void 0===r?t:e(n,t,i,o,a,u)})),n},e.lineEach=c,e.lineReduce=function(t,e,r){var n=r;return c(t,(function(t,i,o,a){n=0===i&&void 0===r?t:e(n,t,i,o,a)})),n},e.propEach=o,e.propReduce=function(t,e,r){var n=r;return o(t,(function(t,i){n=0===i&&void 0===r?t:e(n,t,i)})),n},e.segmentEach=l,e.segmentReduce=function(t,e,r){var n=r,i=!1;return l(t,(function(t,o,a,u,s){n=!1===i&&void 0===r?t:e(n,t,o,a,u,s),i=!0})),n}},351787:(t,e,r)=>{var n=r(382582),i=r(884102),o=r(431540),a=r(813292).default,u=o.featureEach,s=(o.coordEach,i.polygon,i.featureCollection);function l(t){var e=new n(t);return e.insert=function(t){if("Feature"!==t.type)throw new Error("invalid feature");return t.bbox=t.bbox?t.bbox:a(t),n.prototype.insert.call(this,t)},e.load=function(t){var e=[];return Array.isArray(t)?t.forEach((function(t){if("Feature"!==t.type)throw new Error("invalid features");t.bbox=t.bbox?t.bbox:a(t),e.push(t)})):u(t,(function(t){if("Feature"!==t.type)throw new Error("invalid features");t.bbox=t.bbox?t.bbox:a(t),e.push(t)})),n.prototype.load.call(this,e)},e.remove=function(t,e){if("Feature"!==t.type)throw new Error("invalid feature");return t.bbox=t.bbox?t.bbox:a(t),n.prototype.remove.call(this,t,e)},e.clear=function(){return n.prototype.clear.call(this)},e.search=function(t){var e=n.prototype.search.call(this,this.toBBox(t));return s(e)},e.collides=function(t){return n.prototype.collides.call(this,this.toBBox(t))},e.all=function(){var t=n.prototype.all.call(this);return s(t)},e.toJSON=function(){return n.prototype.toJSON.call(this)},e.fromJSON=function(t){return n.prototype.fromJSON.call(this,t)},e.toBBox=function(t){var e;if(t.bbox)e=t.bbox;else if(Array.isArray(t)&&4===t.length)e=t;else if(Array.isArray(t)&&6===t.length)e=[t[0],t[1],t[3],t[4]];else if("Feature"===t.type)e=a(t);else{if("FeatureCollection"!==t.type)throw new Error("invalid geojson");e=a(t)}return{minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}},e}t.exports=l,t.exports.default=l},382582:function(t){t.exports=function(){"use strict";function t(t,n,i,o,a){!function t(r,n,i,o,a){for(;o>i;){if(o-i>600){var u=o-i+1,s=n-i+1,l=Math.log(u),c=.5*Math.exp(2*l/3),h=.5*Math.sqrt(l*c*(u-c)/u)*(s-u/2<0?-1:1);t(r,n,Math.max(i,Math.floor(n-s*c/u+h)),Math.min(o,Math.floor(n+(u-s)*c/u+h)),a)}var f=r[n],p=i,g=o;for(e(r,i,n),a(r[o],f)>0&&e(r,i,o);p<g;){for(e(r,p,g),p++,g--;a(r[p],f)<0;)p++;for(;a(r[g],f)>0;)g--}0===a(r[i],f)?e(r,i,g):e(r,++g,o),g<=n&&(i=g+1),n<=g&&(o=g-1)}}(t,n,i||0,o||t.length-1,a||r)}function e(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function r(t,e){return t<e?-1:t>e?1:0}var n=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function i(t,e,r){if(!r)return e.indexOf(t);for(var n=0;n<e.length;n++)if(r(t,e[n]))return n;return-1}function o(t,e){a(t,0,t.children.length,e,t)}function a(t,e,r,n,i){i||(i=g(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var o=e;o<r;o++){var a=t.children[o];u(i,t.leaf?n(a):a)}return i}function u(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function s(t,e){return t.minX-e.minX}function l(t,e){return t.minY-e.minY}function c(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function h(t){return t.maxX-t.minX+(t.maxY-t.minY)}function f(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function p(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function g(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function d(e,r,n,i,o){for(var a=[r,n];a.length;)if(!((n=a.pop())-(r=a.pop())<=i)){var u=r+Math.ceil((n-r)/i/2)*i;t(e,u,r,n,o),a.push(r,u,u,n)}}return n.prototype.all=function(){return this._all(this.data,[])},n.prototype.search=function(t){var e=this.data,r=[];if(!p(t,e))return r;for(var n=this.toBBox,i=[];e;){for(var o=0;o<e.children.length;o++){var a=e.children[o],u=e.leaf?n(a):a;p(t,u)&&(e.leaf?r.push(a):f(t,u)?this._all(a,r):i.push(a))}e=i.pop()}return r},n.prototype.collides=function(t){var e=this.data;if(!p(t,e))return!1;for(var r=[];e;){for(var n=0;n<e.children.length;n++){var i=e.children[n],o=e.leaf?this.toBBox(i):i;if(p(t,o)){if(e.leaf||f(t,o))return!0;r.push(i)}}e=r.pop()}return!1},n.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0;e<t.length;e++)this.insert(t[e]);return this}var r=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){var n=this.data;this.data=r,r=n}this._insert(r,this.data.height-r.height-1,!0)}else this.data=r;return this},n.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},n.prototype.clear=function(){return this.data=g([]),this},n.prototype.remove=function(t,e){if(!t)return this;for(var r,n,o,a=this.data,u=this.toBBox(t),s=[],l=[];a||s.length;){if(a||(a=s.pop(),n=s[s.length-1],r=l.pop(),o=!0),a.leaf){var c=i(t,a.children,e);if(-1!==c)return a.children.splice(c,1),s.push(a),this._condense(s),this}o||a.leaf||!f(a,u)?n?(r++,a=n.children[r],o=!1):a=null:(s.push(a),l.push(r),r=0,n=a,a=a.children[0])}return this},n.prototype.toBBox=function(t){return t},n.prototype.compareMinX=function(t,e){return t.minX-e.minX},n.prototype.compareMinY=function(t,e){return t.minY-e.minY},n.prototype.toJSON=function(){return this.data},n.prototype.fromJSON=function(t){return this.data=t,this},n.prototype._all=function(t,e){for(var r=[];t;)t.leaf?e.push.apply(e,t.children):r.push.apply(r,t.children),t=r.pop();return e},n.prototype._build=function(t,e,r,n){var i,a=r-e+1,u=this._maxEntries;if(a<=u)return o(i=g(t.slice(e,r+1)),this.toBBox),i;n||(n=Math.ceil(Math.log(a)/Math.log(u)),u=Math.ceil(a/Math.pow(u,n-1))),(i=g([])).leaf=!1,i.height=n;var s=Math.ceil(a/u),l=s*Math.ceil(Math.sqrt(u));d(t,e,r,l,this.compareMinX);for(var c=e;c<=r;c+=l){var h=Math.min(c+l-1,r);d(t,c,h,s,this.compareMinY);for(var f=c;f<=h;f+=s){var p=Math.min(f+s-1,h);i.children.push(this._build(t,f,p,n-1))}}return o(i,this.toBBox),i},n.prototype._chooseSubtree=function(t,e,r,n){for(;n.push(e),!e.leaf&&n.length-1!==r;){for(var i=1/0,o=1/0,a=void 0,u=0;u<e.children.length;u++){var s=e.children[u],l=c(s),h=(f=t,p=s,(Math.max(p.maxX,f.maxX)-Math.min(p.minX,f.minX))*(Math.max(p.maxY,f.maxY)-Math.min(p.minY,f.minY))-l);h<o?(o=h,i=l<i?l:i,a=s):h===o&&l<i&&(i=l,a=s)}e=a||e.children[0]}var f,p;return e},n.prototype._insert=function(t,e,r){var n=r?t:this.toBBox(t),i=[],o=this._chooseSubtree(n,this.data,e,i);for(o.children.push(t),u(o,n);e>=0&&i[e].children.length>this._maxEntries;)this._split(i,e),e--;this._adjustParentBBoxes(n,i,e)},n.prototype._split=function(t,e){var r=t[e],n=r.children.length,i=this._minEntries;this._chooseSplitAxis(r,i,n);var a=this._chooseSplitIndex(r,i,n),u=g(r.children.splice(a,r.children.length-a));u.height=r.height,u.leaf=r.leaf,o(r,this.toBBox),o(u,this.toBBox),e?t[e-1].children.push(u):this._splitRoot(r,u)},n.prototype._splitRoot=function(t,e){this.data=g([t,e]),this.data.height=t.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},n.prototype._chooseSplitIndex=function(t,e,r){for(var n,i,o,u,s,l,h,f=1/0,p=1/0,g=e;g<=r-e;g++){var d=a(t,0,g,this.toBBox),y=a(t,g,r,this.toBBox),m=(i=d,o=y,void 0,void 0,void 0,void 0,u=Math.max(i.minX,o.minX),s=Math.max(i.minY,o.minY),l=Math.min(i.maxX,o.maxX),h=Math.min(i.maxY,o.maxY),Math.max(0,l-u)*Math.max(0,h-s)),v=c(d)+c(y);m<f?(f=m,n=g,p=v<p?v:p):m===f&&v<p&&(p=v,n=g)}return n||r-e},n.prototype._chooseSplitAxis=function(t,e,r){var n=t.leaf?this.compareMinX:s,i=t.leaf?this.compareMinY:l;this._allDistMargin(t,e,r,n)<this._allDistMargin(t,e,r,i)&&t.children.sort(n)},n.prototype._allDistMargin=function(t,e,r,n){t.children.sort(n);for(var i=this.toBBox,o=a(t,0,e,i),s=a(t,r-e,r,i),l=h(o)+h(s),c=e;c<r-e;c++){var f=t.children[c];u(o,t.leaf?i(f):f),l+=h(o)}for(var p=r-e-1;p>=e;p--){var g=t.children[p];u(s,t.leaf?i(g):g),l+=h(s)}return l},n.prototype._adjustParentBBoxes=function(t,e,r){for(var n=r;n>=0;n--)u(e[n],t)},n.prototype._condense=function(t){for(var e=t.length-1,r=void 0;e>=0;e--)0===t[e].children.length?e>0?(r=t[e-1].children).splice(r.indexOf(t[e]),1):this.clear():o(t[e],this.toBBox)},n}()}}]);